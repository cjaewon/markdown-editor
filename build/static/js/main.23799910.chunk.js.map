{"version":3,"sources":["lib/styles/transitions.ts","lib/styles/media.ts","components/write/EditorPanes.tsx","lib/styles/palette.ts","components/write/TitleTextarea.tsx","lib/styles/zIndexes.ts","components/write/Toolbar.tsx","components/common/RoundButton.tsx","components/write/AddLink.tsx","lib/hooks/useInput.tsx","lib/utils.ts","components/common/OpaqueLayer.tsx","components/common/PopupBase.tsx","components/common/Button.tsx","components/common/PopupOKCancel.tsx","modules/write.ts","components/write/AskChangeEditor.tsx","lib/detectIOS.ts","components/write/WriteMarkdownEditor.tsx","components/write/TagInput.tsx","container/write/TagInputContainer.tsx","components/write/WriteFooter.tsx","lib/remark/embedPlugin.ts","container/write/MarkdownEditorContainer.tsx","lib/hooks/useDownload.tsx","lib/remark/prismPlugin.js","lib/styles/prismThemes.ts","components/common/Typography.tsx","lib/katexWhitelist.ts","components/common/MarkdownRender.tsx","components/write/MarkdownPreview.tsx","container/write/MarkdownPreviewContainer.tsx","container/write/EditorPanesContainer.tsx","App.tsx","serviceWorker.ts","modules/core/actions.ts","modules/core/reducer.ts","modules/post.ts","modules/error.ts","modules/scroll.ts","modules/index.ts","index.tsx"],"names":["transitions","fadeIn","keyframes","fadeOut","popInFromBottom","popOutToBottom","popIn","slideUp","slideDown","mediaQuery","maxWidth","media","xxlarge","xlarge","large","medium","small","xsmall","custom","EditorPanesBlock","styled","div","EditorPane","props","shadow","css","RightPane","EditorPanes","theme","left","right","data-testid","style","backgroundColor","palette","teal0","teal1","teal2","teal3","teal4","teal5","teal6","teal7","teal8","teal9","gray0","gray1","gray2","gray3","gray4","gray5","gray6","gray7","gray8","gray9","red0","red1","red2","red3","red4","red5","red6","red7","red8","red9","buttonColorMap","teal","background","color","hoverBackground","lightGray","gray","darkGray","transparent","red","TitleTextareaForSSR","textarea","TitleTextarea","TextareaAutosize","zIndexes","OpaqueLayer","AuthModal","Toolbar","Popup","WriteFooter","PublishScreen","DragDropUpload","ToolbarBlock","forMarkdown","Heading","ToolbarItem","button","Separator","mode","onClick","innerRef","onConvert","ios","id","ref","className","value","RoundButtonBlock","inline","size","border","RoundButton","to","rest","e","preventDefault","AddLinkBlock","useCallback","React","useRef","useEffect","AddLink","top","bottom","stickToRight","onConfirm","onClose","onDelete","defaultValue","useState","input","setInput","target","useInput","onChange","onSubmit","current","focus","onOutsideClick","placeholder","updateKey","state","key","detectJSDOM","navigator","userAgent","includes","ssrEnabled","process","REACT_APP_SSR","OpaqueLayerBlock","visible","animate","setAnimate","timeoutId","mounted","closed","setClosed","document","body","overflowY","setTimeout","clearTimeout","PopupBaseBlock","PopupWrapper","PopupBase","children","ButtonBlock","responsive","Button","htmlProps","blur","WriteMode","PopupOKCancelBlock","PopupOKCancel","title","onCancel","createStandardAction","deprecated","changeMarkdown","changeTitle","convertEditorMode","setHtml","changeTags","openPublish","setDefaultDescription","setThumbnail","setInitialBody","initialState","MARKDOWN","markdown","html","tags","publish","textBody","defaultDescription","description","isPrivate","urlSlug","thumbnail","editSeries","selectedSeries","postId","isTemp","initialTitle","initialBody","write","handlers","action","handler","type","createReducer","payload","WYSIWYG","slice","isMarkdown","series","AskChangeEditor","convertTo","detectIOS","checkAgent","test","window","MSStream","checkPlatform","platform","maxTouchPoints","require","checkEmbed","text","keys","Object","checker","i","length","code","fn","removeHeading","replace","WriterHead","hide","screenHeight","screen","height","springStyle","useSpring","maxHeight","opacity","config","duration","PaddingWrapper","WriteMarkdownEditor","block","toolbarElement","editorElement","appleEditorElement","toolbarTop","addLink","askChangeEditor","clientWidth","hideUpper","appleCursorPos","codemirror","ignore","isIOS","initialize","CodeMirror","fromTextArea","lineWrapping","setValue","on","cm","onChangeMarkdown","getValue","stickToBottomIfNeeded","doc","getDoc","line","getCursor","lastLine","preview","getElementById","scrollTop","scrollHeight","info","getScrollInfo","setState","dataTransfer","dropEffect","console","log","editor","clipboardData","originalEvent","getData","check","selection","getSelection","replaceSelection","cursor","pos","ch","replaceRange","items","kind","clientHeight","scrollTo","handleResize","addImageToEditor","image","cursorPos","selectionEnd","textBefore","textAfter","imageMarkdown","encodeURI","nextCursorPos","selectionStart","handleOpenAddLink","cursorCoords","calculatedTop","defaultTextHeight","handleConfirmAddLink","link","setSelection","setCursor","handleCancelAddLink","handleToolbarClickForApple","sliced","lastNewLineIndex","lastIndexOf","currentNewLineIndex","indexOf","lineText","textBelowCurrentLine","setCursorPos","heading1","replacedLine","posDiff","heading2","heading3","heading4","handleToolbarClick","start","end","getLine","map","number","characters","repeat","plain","reduce","headingHandlers","index","assign","bold","selected","getRange","italic","selectLeftAndRight","strike","blockquote","matches","codeblock","handleTitleChange","onChangeTitle","handleAskConvert","handleConfirmConvert","handleCancelConvert","handleAppleTextareaChange","prevProps","this","getBoundingClientRect","addEventListener","removeEventListener","tagInput","footer","MarkdownEditorBlock","rows","HorizontalBar","MarkdownWrapper","display","AppleTextarea","FooterWrapper","width","youtube","result","exec","twitter","regex","links","match","push","pathMatch","codesandbox","codepen","TagItem","Tag","Help","useTransition","from","transform","enter","leave","tension","friction","HelpBlock","item","TagInputBlock","StyledInput","TagInput","initialTags","setTags","setFocus","editableDiv","innerText","insertTag","tag","processed","trim","tempTags","execArray","charAt","onKeyDown","nextTags","filter","t","onRemove","tabIndex","onFocus","onBlur","mapDispatchToProps","connect","WriteFooterBlock","Group","StyledButton","onGoBack","onSave","edit","embedTypeRegex","converters","embedPlugin","tree","file","visit","node","findIndex","childNode","siblingNode","label","splice","MarkdownEditorContainer","useSelector","setLastSavedData","dispatch","useDispatch","actionCreators","useMemo","bindActionCreators","onDownload","element","createElement","setAttribute","encodeURIComponent","appendChild","click","removeChild","header","join","remark","use","breaks","htmlPlugin","err","String","attacher","include","exclude","visitor","lang","data","hProperties","prism","Prism","highlighted","highlight","languages","markup","ast","prismThemes","github","monokai","dracula","TypographyBlock","Typography","attributes","acc","katexWhitelist","styles","MarkdownRenderBlock","sanitize","allowedTags","allowedAttributes","a","img","iframe","span","allowedStyles","allowedIframeHostnames","MarkdownRenderErrorBoundary","hasError","onError","hasTagError","codeTheme","onConvertFinish","editing","remarkParse","slug","prismPlugin","remark2rehype","allowDangerousHTML","raw","math","katex","stringify","processSync","toString","setElement","setHasTagError","delay","setDelay","throttledUpdate","throttle","lines","split","nextDelay","Math","max","min","floor","url","Promise","resolve","reject","script","onload","onerror","src","head","el","parse","rel","href","integrity","crossOrigin","dangerouslySetInnerHTML","__html","MarkdownPreviewBlock","Title","h1","MarkdownPreview","EditorPanesContainer","App","Boolean","location","hostname","core","layer","auth","popup","message","produce","draft","post","createSlice","name","reducers","setPostId","error","errorType","showNotFound","reset","scroll","main","preserveScroll","rootReducer","combineReducers","reducer","store","createStore","__REDUX_STATE__","ReactDOM","render","StrictMode","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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B0B,GAAO,CACX,OACA,aACA,YACA,QACA,KACA,KACA,KACA,SACA,QACA,SACA,aACA,OACA,OACA,UACA,QACA,QACA,QACA,SACA,MACA,MACA,aACA,OACA,WACA,SACA,UACA,WACA,SACA,MACA,OACA,QAGI+S,GAAa/S,GAAK+J,QAAO,SAACiJ,EAAKxW,GAEnC,OADAwW,EAAIxW,GAAW,CAAC,KACTwW,IACN,IAoCYC,GANQ,CACrBjT,QACA+S,cACAG,OA/Ba,CACb,mBACA,sBACA,eACA,qBACA,qBACA,mBACA,eACA,eACA,SACA,QACA,SACA,OACA,SACA,cACA,eACA,aACA,YACA,eACA,WACA,MACA,QACA,kBACAnJ,QAAO,SAACiJ,EAAKxW,GAEb,OADAwW,EAAIxW,GAAW,CAAC,MACTwW,IACN,K,qmDChCH,IAAMG,GAAsB1d,IAAOC,IAAV,KAEnB+c,GAAY,iBAGZA,GAAY,kBAGZA,GAAW,OAGXA,GAAW,QAGXA,GAAW,QAYXzd,EAAMK,MAsCYkB,EAAQkB,MAKClB,EAAQkB,MAUVlB,EAAQkB,MAInBlB,EAAQY,OAY5B,SAASsX,GAAO1O,GACd,OAAOqT,KAASrT,EAAM,CACpBsT,YAAY,CACV,KACA,KACA,KACA,KACA,KACA,KACA,aACA,IACA,IACA,KACA,KACA,KACA,KACA,IACA,IACA,SACA,KACA,SACA,OACA,KACA,KACA,MACA,QACA,QACA,UACA,QACA,KACA,KACA,KACA,MACA,SACA,OACA,MACA,MACA,SAnCS,oBAqCNJ,GAAejT,OAEpBsT,kBAAkB,aAChBC,EAAG,CAAC,OAAQ,OAAQ,UACpBC,IAAK,CAAC,OACNC,OAAQ,CAAC,MAAO,QAAS,kBAAmB,YAAa,SACzD,IAAK,CAAC,QAAS,KAAM,eACrBC,KAAM,CAAC,SACPxX,MAAO,CAAC,SACL+W,GAAeF,YAEpBY,cAAe,CACb,IAAK,CAEHlb,MAAO,CACL,qBACA,4DAEF,aAAc,CAAC,SAAU,UAAW,aAEtCib,KAAK,eACAT,GAAeC,SAGtBU,uBAAwB,CAAC,kBAAmB,iBAAkB,gB,IAI1D3X,GAAwBX,WAA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","file":"static/js/main.23799910.chunk.js","sourcesContent":["import { keyframes } from 'styled-components';\r\n\r\nconst fadeIn = keyframes`\r\n  0% {\r\n    opacity: 0;\r\n  }\r\n  100% {\r\n    opacity: 1;\r\n  }\r\n`;\r\n\r\nconst fadeOut = keyframes`\r\n  0% {\r\n    opacity: 1;\r\n  }\r\n  100% {\r\n    opacity: 0;\r\n  }\r\n`;\r\n\r\nconst popInFromBottom = keyframes`\r\n  0% {\r\n    opacity: 0;\r\n    transform: translateY(400px) scale(0.75);\r\n  }\r\n  75% {\r\n    opacity: 1;\r\n    transform: translateY(-16px) scale(1.0);\r\n  }\r\n  100% {\r\n    opacity: 1;\r\n    transform: translateY(0px);\r\n  }`;\r\n\r\nconst popOutToBottom = keyframes`\r\n  0% {\r\n    opacity: 1;\r\n    transform: translateY(0px) scale(1.0);\r\n  }\r\n  100% {\r\n    opacity: 0;\r\n    transform: translateY(400px) scale(0.75);\r\n  }`;\r\n\r\nconst popIn = keyframes`\r\n  0% {\r\n    opacity: 0.7;\r\n    transform: scale3d(0.8, 0.8, 1);\r\n  }\r\n  100% {\r\n    opacity: 1;\r\n    transform: scale3d(1, 1, 1);\r\n  }\r\n`;\r\n\r\nconst slideUp = keyframes`\r\n  0% {\r\n    transform: translateY(100%);\r\n  }\r\n  100% {\r\n    transform: translateY(0%);\r\n  };\r\n`;\r\n\r\nconst slideDown = keyframes`\r\n  0% {\r\n    transform: translateY(0%);\r\n  }\r\n  100% {\r\n    transform: translateY(100%);\r\n  };\r\n`;\r\n\r\nconst transitions = {\r\n  fadeIn,\r\n  fadeOut,\r\n  popInFromBottom,\r\n  popOutToBottom,\r\n  popIn,\r\n  slideUp,\r\n  slideDown,\r\n};\r\n\r\nexport default transitions;\r\n","export const mediaQuery = (maxWidth: number) => `\r\n  @media (max-width: ${maxWidth}px)\r\n`;\r\n\r\nconst media = {\r\n  xxlarge: mediaQuery(1920),\r\n  xlarge: mediaQuery(1440),\r\n  large: mediaQuery(1200),\r\n  medium: mediaQuery(1024),\r\n  small: mediaQuery(768),\r\n  xsmall: mediaQuery(375),\r\n  custom: mediaQuery,\r\n};\r\n\r\nexport default media;\r\n","import * as React from 'react';\r\nimport styled, { css } from 'styled-components';\r\n\r\nimport transitions from '../../lib/styles/transitions';\r\nimport media from '../../lib/styles/media';\r\nconst EditorPanesBlock = styled.div`\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  animation: ${transitions.fadeIn} 0.5s forwards;\r\n`;\r\nconst EditorPane = styled.div<{ shadow?: boolean }>`\r\n  min-width: 0;\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  position: relative;\r\n  ${props =>\r\n    props.shadow &&\r\n    css`\r\n      z-index: 1;\r\n      box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.015);\r\n    `}\r\n`;\r\n\r\nconst RightPane = styled(EditorPane)`\r\n  ${media.medium} {\r\n    display: none;\r\n  }\r\n`;\r\n\r\nexport interface EditorPanesProps {\r\n  theme?: 'LIGHT' | 'DARK';\r\n  left?: React.ReactNode;\r\n  right?: React.ReactNode;\r\n}\r\n\r\nconst EditorPanes: React.FC<EditorPanesProps> = ({\r\n  theme = 'LIGHT',\r\n  left,\r\n  right,\r\n}) => {\r\n  return (\r\n    <EditorPanesBlock>\r\n      <EditorPane\r\n        shadow\r\n        data-testid=\"left\"\r\n        style={{\r\n          backgroundColor: theme === 'DARK' ? '#263238' : 'white',\r\n        }}\r\n      >\r\n        {left}\r\n      </EditorPane>\r\n      <RightPane\r\n        data-testid=\"right\"\r\n        style={{\r\n          backgroundColor: theme === 'DARK' ? 'white' : '#fbfdfc',\r\n        }}\r\n      >\r\n        {right}\r\n      </RightPane>\r\n    </EditorPanesBlock>\r\n  );\r\n};\r\n\r\nexport default EditorPanes;\r\n","const palette = {\r\n  /* teal */\r\n  teal0: '#F3FFFB',\r\n  teal1: '#C3FAE8',\r\n  teal2: '#96F2D7',\r\n  teal3: '#63E6BE',\r\n  teal4: '#38D9A9',\r\n  teal5: '#20C997',\r\n  teal6: '#12B886',\r\n  teal7: '#0CA678',\r\n  teal8: '#099268',\r\n  teal9: '#087F5B',\r\n  /* gray */\r\n  gray0: '#F8F9FA',\r\n  gray1: '#F1F3F5',\r\n  gray2: '#E9ECEF',\r\n  gray3: '#DEE2E6',\r\n  gray4: '#CED4DA',\r\n  gray5: '#ADB5BD',\r\n  gray6: '#868E96',\r\n  gray7: '#495057',\r\n  gray8: '#343A40',\r\n  gray9: '#212529',\r\n  /* red */\r\n  red0: '#fff5f5',\r\n  red1: '#ffe3e3',\r\n  red2: '#ffc9c9',\r\n  red3: '#ffa8a8',\r\n  red4: '#ff8787',\r\n  red5: '#ff6b6b',\r\n  red6: '#fa5252',\r\n  red7: '#f03e3e',\r\n  red8: '#e03131',\r\n  red9: '#c92a2a',\r\n};\r\n\r\nexport const buttonColorMap: {\r\n  [color: string]: {\r\n    background: string;\r\n    color: string;\r\n    hoverBackground: string;\r\n  };\r\n} = {\r\n  teal: {\r\n    background: palette.teal6,\r\n    color: 'white',\r\n    hoverBackground: palette.teal5,\r\n  },\r\n  lightGray: {\r\n    background: palette.gray2,\r\n    color: palette.gray7,\r\n    hoverBackground: palette.gray1,\r\n  },\r\n  gray: {\r\n    background: palette.gray6,\r\n    color: 'white',\r\n    hoverBackground: palette.gray5,\r\n  },\r\n  darkGray: {\r\n    background: palette.gray8,\r\n    color: 'white',\r\n    hoverBackground: palette.gray6,\r\n  },\r\n  transparent: {\r\n    background: 'none',\r\n    color: palette.teal6,\r\n    hoverBackground: palette.teal1,\r\n  },\r\n  red: {\r\n    background: palette.red5,\r\n    color: 'white',\r\n    hoverBackground: palette.red4,\r\n  },\r\n};\r\n\r\nexport default palette;\r\n","import styled, { css } from 'styled-components';\r\nimport TextareaAutosize from 'react-textarea-autosize';\r\nimport palette from '../../lib/styles/palette';\r\nimport { mediaQuery } from '../../lib/styles/media';\r\n\r\nconst style = css`\r\n  display: block;\r\n  padding: 0;\r\n  font-size: 2.75rem;\r\n  ${mediaQuery(767)} {\r\n    font-size: 1.8rem;\r\n  }\r\n  width: 100%;\r\n  resize: none;\r\n  line-height: 1.5;\r\n  outline: none;\r\n  border: none;\r\n  font-weight: bold;\r\n  color: ${palette.gray9};\r\n  &::placeholder {\r\n    color: ${palette.gray5};\r\n  }\r\n`;\r\n\r\nexport const TitleTextareaForSSR = styled.textarea`\r\n  ${style}\r\n`;\r\n\r\nconst TitleTextarea = styled(TextareaAutosize)`\r\n  ${style}\r\n`;\r\n\r\nexport default TitleTextarea;\r\n","const zIndexes = {\r\n  OpaqueLayer: 10,\r\n  AuthModal: 20,\r\n  Toolbar: 10,\r\n  Popup: 25,\r\n  WriteFooter: 10,\r\n  PublishScreen: 15,\r\n  DragDropUpload: 100,\r\n};\r\n\r\nexport default zIndexes;\r\n","import * as React from 'react';\r\nimport styled, { css } from 'styled-components';\r\nimport {\r\n  MdFormatBold,\r\n  MdFormatItalic,\r\n  MdFormatUnderlined,\r\n  MdFormatStrikethrough,\r\n  MdInsertLink,\r\n  MdFormatQuote,\r\n  MdImage,\r\n  MdCode,\r\n} from 'react-icons/md';\r\nimport palette from '../../lib/styles/palette';\r\nimport zIndexes from '../../lib/styles/zIndexes';\r\nimport { mediaQuery } from '../../lib/styles/media';\r\n\r\n// box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.09);\r\nconst ToolbarBlock = styled.div<{\r\n  shadow: boolean;\r\n  forMarkdown: boolean;\r\n}>`\r\n  width: 100%;\r\n  top: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 1rem;\r\n  width: 100%;\r\n  background: white;\r\n  z-index: ${zIndexes.Toolbar};\r\n  transition: all 0.125s ease-in;\r\n  flex-wrap: wrap;\r\n\r\n  ${props =>\r\n    props.forMarkdown &&\r\n    css`\r\n      margin-bottom: 1rem;\r\n      padding-left: 3rem;\r\n      padding-right: 3rem;\r\n\r\n      ${mediaQuery(767)} {\r\n        padding-left: 1rem;\r\n        padding-right: 1rem;\r\n        flex-wrap: unset;\r\n        overflow-x: auto;\r\n      }\r\n      width: auto;\r\n    `}\r\n\r\n  ${props =>\r\n    props.shadow &&\r\n    css`\r\n      box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.09);\r\n      margin-bottom: 0;\r\n    `}\r\n\r\n  .mobile-placeholder {\r\n    display: none;\r\n    ${mediaQuery(767)} {\r\n      display: block;\r\n    }\r\n    height: 1px;\r\n    width: 1rem;\r\n    flex-shrink: 0;\r\n  }\r\n`;\r\n\r\n// const ToolbarGroup = styled.div`\r\n//   display: flex;\r\n//   height: 100%;\r\n// `;\r\n\r\nconst Heading = styled.div`\r\n  font-size: 1rem;\r\n  font-weight: bold;\r\n  font-family: serif;\r\n  span {\r\n    font-size: 0.75rem;\r\n  }\r\n`;\r\nconst ToolbarItem = styled.button`\r\n  width: 3rem;\r\n  height: 3rem;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 1.75rem;\r\n  color: ${palette.gray6};\r\n  cursor: pointer;\r\n  flex-shrink: 0;\r\n\r\n  ${mediaQuery(767)} {\r\n    width: 2.5rem;\r\n    height: 2.5rem;\r\n    font-size: 1.45rem;\r\n  }\r\n  &:hover {\r\n    color: ${palette.gray9};\r\n    background: ${palette.gray0};\r\n  }\r\n  background: none;\r\n  outline: none;\r\n  border: none;\r\n  padding: 0;\r\n\r\n  &.ql-active {\r\n    color: ${palette.teal6};\r\n  }\r\n`;\r\n\r\nconst Separator = styled.div`\r\n  width: 1px;\r\n  height: 1.25rem;\r\n  margin-left: 0.5rem;\r\n  margin-right: 0.5rem;\r\n  background: ${palette.gray4};\r\n`;\r\nexport interface ToolbarProps {\r\n  shadow: boolean;\r\n  mode: 'MARKDOWN' | 'WYSIWYG';\r\n  onClick?: Function;\r\n  onConvert?: () => void;\r\n  innerRef?: React.RefObject<HTMLDivElement>;\r\n  ios?: boolean;\r\n}\r\n\r\nconst Toolbar: React.FC<ToolbarProps> = ({\r\n  shadow,\r\n  mode,\r\n  onClick = () => {},\r\n  onConvert,\r\n  innerRef,\r\n  ios,\r\n}) => {\r\n  const forMarkdown = mode === 'MARKDOWN';\r\n  return (\r\n    <ToolbarBlock\r\n      id=\"toolbar\"\r\n      shadow={shadow}\r\n      forMarkdown={forMarkdown}\r\n      ref={innerRef}\r\n    >\r\n      <ToolbarItem\r\n        className=\"ql-header\"\r\n        value={1}\r\n        onClick={() => onClick('heading1')}\r\n      >\r\n        <Heading>\r\n          H<span>1</span>\r\n        </Heading>\r\n      </ToolbarItem>\r\n      <ToolbarItem\r\n        className=\"ql-header\"\r\n        value={2}\r\n        onClick={() => onClick('heading2')}\r\n      >\r\n        <Heading>\r\n          H<span>2</span>\r\n        </Heading>\r\n      </ToolbarItem>\r\n      <ToolbarItem\r\n        className=\"ql-header\"\r\n        value={3}\r\n        onClick={() => onClick('heading3')}\r\n      >\r\n        <Heading>\r\n          H<span>3</span>\r\n        </Heading>\r\n      </ToolbarItem>\r\n      <ToolbarItem\r\n        className=\"ql-header\"\r\n        value={4}\r\n        onClick={() => onClick('heading4')}\r\n      >\r\n        <Heading>\r\n          H<span>4</span>\r\n        </Heading>\r\n      </ToolbarItem>\r\n      <Separator />\r\n      {!ios && (\r\n        <>\r\n          <ToolbarItem className=\"ql-bold\" onClick={() => onClick('bold')}>\r\n            <MdFormatBold />\r\n          </ToolbarItem>\r\n          <ToolbarItem className=\"ql-italic\" onClick={() => onClick('italic')}>\r\n            <MdFormatItalic />\r\n          </ToolbarItem>\r\n          {!forMarkdown && (\r\n            <ToolbarItem className=\"ql-underline\">\r\n              <MdFormatUnderlined />\r\n            </ToolbarItem>\r\n          )}\r\n          <ToolbarItem className=\"ql-strike\" onClick={() => onClick('strike')}>\r\n            <MdFormatStrikethrough />\r\n          </ToolbarItem>\r\n          <Separator />\r\n          <ToolbarItem\r\n            className=\"ql-blockquote\"\r\n            onClick={() => onClick('blockquote')}\r\n          >\r\n            <MdFormatQuote />\r\n          </ToolbarItem>\r\n          <ToolbarItem className=\"ql-link\" onClick={() => onClick('link')}>\r\n            <MdInsertLink />\r\n          </ToolbarItem>\r\n        </>\r\n      )}\r\n      <ToolbarItem className=\"ql-image\" onClick={() => onClick('image')}>\r\n        <MdImage />\r\n      </ToolbarItem>\r\n\r\n      {!ios && (\r\n        <ToolbarItem\r\n          className=\"ql-code-block\"\r\n          onClick={() => onClick('codeblock')}\r\n        >\r\n          <MdCode />\r\n        </ToolbarItem>\r\n      )}\r\n      <div className=\"mobile-placeholder\"></div>\r\n      {/* <Separator /> */}\r\n      {/* <ToolbarGroup> */}\r\n      {/* forMarkdown ? (\r\n          <ToolbarItem data-testid=\"quillconvert\" onClick={onConvert}>\r\n            <MdRemoveRedEye />\r\n          </ToolbarItem>\r\n        ) : (\r\n          <ToolbarItem data-testid=\"mdconvert\" onClick={onConvert}>\r\n            <FaMarkdown />\r\n          </ToolbarItem>\r\n        ) */}\r\n      {/* </ToolbarGroup> */}\r\n    </ToolbarBlock>\r\n  );\r\n};\r\n\r\nexport default Toolbar;\r\n","import * as React from 'react';\r\nimport styled, { css } from 'styled-components';\r\nimport { buttonColorMap } from '../../lib/styles/palette';\r\n// import { Route } from 'react-router';\r\n\r\ntype ButtonSize = 'SMALL' | 'DEFAULT' | 'LARGE';\r\n\r\ntype RoundButtonBlockProps = {\r\n  inline?: boolean;\r\n  color: string;\r\n  size: ButtonSize;\r\n  border: boolean;\r\n};\r\n\r\nconst RoundButtonBlock = styled.button<RoundButtonBlockProps>`\r\n  ${props =>\r\n    props.inline &&\r\n    css`\r\n      & + & {\r\n        margin-left: 1rem;\r\n      }\r\n    `}\r\n\r\n  ${props =>\r\n    props.size === 'SMALL' &&\r\n    css`\r\n      height: 1.5rem;\r\n      padding-left: 0.75rem;\r\n      padding-right: 0.75rem;\r\n      font-size: 0.875rem;\r\n      border-radius: 0.75rem;\r\n    `};\r\n  ${props =>\r\n    props.size === 'DEFAULT' &&\r\n    css`\r\n      height: 2rem;\r\n      padding-left: 1rem;\r\n      padding-right: 1rem;\r\n      font-size: 1rem;\r\n      border-radius: 1rem;\r\n    `};\r\n  ${props =>\r\n    props.size === 'LARGE' &&\r\n    css`\r\n      height: 3rem;\r\n      font-size: 1.5rem;\r\n      padding-left: 2rem;\r\n      padding-right: 2rem;\r\n      border-radius: 1.5rem;\r\n    `}\r\n\r\n  background: none;\r\n  border: none;\r\n  outline: none;\r\n  font-weight: bold;\r\n  word-break: keep-all;\r\n  background: ${props => buttonColorMap[props.color].background};\r\n  color: ${props => buttonColorMap[props.color].color};\r\n  &:hover {\r\n    background: ${props => buttonColorMap[props.color].hoverBackground};\r\n  }\r\n\r\n  ${props =>\r\n    props.border &&\r\n    css<RoundButtonBlockProps>`\r\n      background: white;\r\n      border: 1px solid ${props => buttonColorMap[props.color].background};\r\n      color: ${props => buttonColorMap[props.color].background};\r\n      &:hover {\r\n        background: ${props => buttonColorMap[props.color].background};\r\n        color: white;\r\n      }\r\n    `}\r\n\r\n  transition: 0.125s all ease-in;\r\n  &:focus {\r\n    box-shadow: 0px 2px 12px #00000030;\r\n  }\r\n  cursor: pointer;\r\n`;\r\n\r\ntype ButtonProps = React.DetailedHTMLProps<\r\n  React.ButtonHTMLAttributes<HTMLButtonElement>,\r\n  HTMLButtonElement\r\n>;\r\n\r\ninterface RoundButtonProps extends ButtonProps {\r\n  inline?: boolean;\r\n  to?: string;\r\n  size?: ButtonSize;\r\n  color?: 'teal' | 'gray' | 'darkGray' | 'lightGray';\r\n  border?: boolean;\r\n}\r\n\r\nconst RoundButton: React.FC<RoundButtonProps> = ({\r\n  ref,\r\n  to,\r\n  color = 'teal',\r\n  size = 'DEFAULT',\r\n  border = false,\r\n  ...rest\r\n}) => {\r\n  if (to) {\r\n    return (\r\n      <RoundButtonBlock\r\n        color={color}\r\n        onClick={e => {\r\n          e.preventDefault();\r\n        }}\r\n        size={size}\r\n        border={border}\r\n        {...rest}\r\n      />\r\n    );\r\n  }\r\n  return (\r\n    <RoundButtonBlock color={color} size={size} border={border} {...rest} />\r\n  );\r\n};\r\n\r\nexport default RoundButton;\r\n","import * as React from 'react';\r\nimport styled from 'styled-components';\r\nimport OutsideClickHandler from 'react-outside-click-handler';\r\nimport useInput from '../../lib/hooks/useInput';\r\nimport palette from '../../lib/styles/palette';\r\nimport RoundButton from '../common/RoundButton';\r\nimport { MdDelete } from 'react-icons/md';\r\n\r\nconst AddLinkBlock = styled.div`\r\n  z-index: 5;\r\n  position: absolute;\r\n  margin-bottom: 1rem;\r\n  & > .wrapper {\r\n    margin-top: 1rem;\r\n    width: 20rem;\r\n    background: white;\r\n    box-shadow: 0px 0px 4px rgba(0, 0, 0, 0.08);\r\n    border-radius: 4px;\r\n    .top-wrapper {\r\n      margin-bottom: 1rem;\r\n      .title {\r\n        font-weight: bold;\r\n        color: ${palette.gray8};\r\n      }\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      svg {\r\n        font-size: 1.5rem;\r\n        color: ${palette.gray5};\r\n        cursor: pointer;\r\n        &:hover {\r\n          color: ${palette.gray9};\r\n        }\r\n      }\r\n    }\r\n    form {\r\n      width: 100%;\r\n      display: flex;\r\n      align-items: center;\r\n      input {\r\n        flex: 1;\r\n        border: none;\r\n        outline: none;\r\n        border-bottom: 1px inset ${palette.gray5};\r\n        font-size: 1rem;\r\n        margin-right: 0.5rem;\r\n        line-height: 1.5;\r\n        padding: 0;\r\n      }\r\n    }\r\n    padding: 1.5rem 1rem;\r\n  }\r\n`;\r\n\r\ninterface AddLinkProps {\r\n  left: number;\r\n  top: number | null;\r\n  bottom: number | null;\r\n  stickToRight?: boolean;\r\n  onConfirm: (link: string) => void;\r\n  onClose: () => void;\r\n  onDelete?: () => void;\r\n  defaultValue: string;\r\n}\r\n\r\nconst { useCallback, useRef, useEffect } = React;\r\n\r\nconst AddLink: React.FC<AddLinkProps> = ({\r\n  left,\r\n  top,\r\n  bottom,\r\n  stickToRight,\r\n  onConfirm,\r\n  onClose,\r\n  onDelete,\r\n  defaultValue,\r\n}) => {\r\n  const [value, onChange] = useInput(defaultValue);\r\n  const onSubmit = useCallback(\r\n    (e: React.FormEvent<HTMLFormElement>) => {\r\n      e.preventDefault();\r\n      onConfirm(value);\r\n    },\r\n    [onConfirm, value],\r\n  );\r\n  const input = useRef<HTMLInputElement>(null);\r\n  useEffect(() => {\r\n    if (!input.current) return;\r\n    input.current.focus();\r\n  }, []);\r\n  return (\r\n    <OutsideClickHandler onOutsideClick={onClose}>\r\n      <AddLinkBlock\r\n        style={{\r\n          left: stickToRight ? 'initial' : left,\r\n          top: top || 'initial',\r\n          bottom: bottom || 'initial',\r\n          right: stickToRight ? '3rem' : 'initial',\r\n        }}\r\n      >\r\n        <div className=\"wrapper\">\r\n          <div className=\"top-wrapper\">\r\n            <div className=\"title\">링크 {defaultValue ? '수정' : '등록'}</div>\r\n            {defaultValue && <MdDelete onClick={onDelete} />}\r\n          </div>\r\n          <form onSubmit={onSubmit}>\r\n            <input\r\n              value={value}\r\n              onChange={onChange}\r\n              placeholder=\"URL 을 입력하세요\"\r\n              ref={input}\r\n            />\r\n            <RoundButton color=\"darkGray\" size=\"SMALL\">\r\n              확인\r\n            </RoundButton>\r\n          </form>\r\n        </div>\r\n      </AddLinkBlock>\r\n    </OutsideClickHandler>\r\n  );\r\n};\r\n\r\nexport default AddLink;\r\n","import { useState, useCallback } from 'react';\r\n\r\nexport default function useInput(defaultValue: string) {\r\n  const [input, setInput] = useState(defaultValue);\r\n  const onChange = useCallback(\r\n    (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n      setInput(e.target.value);\r\n    },\r\n    [],\r\n  );\r\n  const onReset = useCallback(() => setInput(''), []);\r\n  return [input, onChange, onReset] as [\r\n    string,\r\n    typeof onChange,\r\n    typeof onReset\r\n  ];\r\n}\r\n","import distanceInWordsToNow from 'date-fns/formatDistanceToNow';\r\nimport format from 'date-fns/format';\r\nimport koLocale from 'date-fns/locale/ko';\r\n\r\nexport const formatDate = (date: string): string => {\r\n  const d = new Date(date);\r\n  const now = Date.now();\r\n  const diff = now - new Date(date).getTime();\r\n  // less than 5 minutes\r\n  if (diff < 1000 * 60 * 5) {\r\n    return '방금 전';\r\n  }\r\n  if (diff < 1000 * 60 * 60 * 24) {\r\n    return distanceInWordsToNow(d, { addSuffix: true, locale: koLocale });\r\n  }\r\n  if (diff < 1000 * 60 * 60 * 36) {\r\n    return '어제';\r\n  }\r\n  if (diff < 1000 * 60 * 60 * 24 * 7) {\r\n    return distanceInWordsToNow(d, { addSuffix: true, locale: koLocale });\r\n  }\r\n  return format(d, 'yyyy년 M월 d일');\r\n};\r\n\r\nexport const getScrollTop = () => {\r\n  if (!document.body) return 0;\r\n  const scrollTop = document.documentElement\r\n    ? document.documentElement.scrollTop || document.body.scrollTop\r\n    : document.body.scrollTop;\r\n  return scrollTop;\r\n};\r\n\r\nexport const getScrollBottom = () => {\r\n  if (!document.body) return 0;\r\n  const { scrollHeight } = document.body;\r\n  const { innerHeight } = window;\r\n  const scrollTop = getScrollTop();\r\n  return scrollHeight - innerHeight - scrollTop;\r\n};\r\n\r\nexport type Handlers<T> = {\r\n  [type: string]: (state: T, action: any) => T;\r\n};\r\n\r\nexport function createReducer<S>(handlers: Handlers<S>, initialState: S) {\r\n  return (state: S = initialState, action: any) => {\r\n    const handler = handlers[action.type];\r\n    if (!handler) return state;\r\n    return handler(state, action);\r\n  };\r\n}\r\n\r\nexport function updateKey<S, K extends keyof S>(\r\n  state: S,\r\n  key: K,\r\n  value: S[K],\r\n): S {\r\n  return {\r\n    ...state,\r\n    [key]: value,\r\n  };\r\n}\r\n\r\nexport function detectJSDOM() {\r\n  if (typeof navigator === 'undefined') return false;\r\n  return navigator.userAgent.includes('jsdom');\r\n}\r\n\r\nexport const escapeForUrl = (text: string): string => {\r\n  return text\r\n    .replace(\r\n      /[^0-9a-zA-Zㄱ-힣.\\u3000-\\u303f\\u3040-\\u309f\\u30a0-\\u30ff\\uff00-\\uff9f\\u4e00-\\u9faf\\u3400-\\u4dbf -]/g,\r\n      '',\r\n    )\r\n    .trim()\r\n    .replace(/ /g, '-')\r\n    .replace(/--+/g, '-');\r\n};\r\n\r\nexport function safe<T>(callback: () => T) {\r\n  try {\r\n    return callback();\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function sleep(ms: number) {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\nexport function loadScript(url: string) {\r\n  return new Promise((resolve, reject) => {\r\n    const script = document.createElement('script');\r\n    script.onload = function onload() {\r\n      resolve();\r\n    };\r\n    script.onerror = function onerror() {\r\n      reject();\r\n    };\r\n    script.src = url;\r\n    if (!document || !document.head) return;\r\n    document.head.appendChild(script);\r\n  });\r\n}\r\n\r\nexport const createFallbackTitle = (username: string | null) => {\r\n  if (!username) return '';\r\n  // const lastChar = username.slice(-1).toLowerCase();\r\n  // if (lastChar === 's') {\r\n  //   return `${username}' velog`;\r\n  // }\r\n  // return `${username}'s velog`;\r\n  return `${username}.log`;\r\n};\r\n\r\nexport const ssrEnabled = process.env.REACT_APP_SSR === 'enabled';\r\n","import * as React from 'react';\r\nimport styled, { css } from 'styled-components';\r\nimport transitions from '../../lib/styles/transitions';\r\nimport zIndexes from '../../lib/styles/zIndexes';\r\n\r\nconst OpaqueLayerBlock = styled.div<{\r\n  animate: boolean;\r\n  visible: boolean;\r\n}>`\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: rgba(249, 249, 249, 0.85);\r\n  z-index: ${zIndexes.OpaqueLayer};\r\n\r\n  ${props =>\r\n    props.visible\r\n      ? css`\r\n          animation: ${transitions.fadeIn} 0.25s forwards;\r\n        `\r\n      : css`\r\n          animation: ${transitions.fadeOut} 0.25s forwards;\r\n        `}\r\n`;\r\n\r\ninterface OpaqueLayerProps {\r\n  visible: boolean;\r\n}\r\n\r\nconst { useState, useEffect, useRef } = React;\r\n\r\nconst OpaqueLayer: React.FC<OpaqueLayerProps> = ({ visible }) => {\r\n  const [animate, setAnimate] = useState(false);\r\n  const timeoutId = useRef<number | null>(null);\r\n  const mounted = useRef(false);\r\n  const [closed, setClosed] = useState(true);\r\n\r\n  // activates animation & hides and unhides scrollbar\r\n  useEffect(() => {\r\n    // scrollbar\r\n    document.body.style.overflowY = visible ? 'hidden' : 'initial';\r\n\r\n    // animate\r\n    if (!mounted.current) {\r\n      mounted.current = true;\r\n    } else {\r\n      setAnimate(true);\r\n      timeoutId.current = setTimeout(() => {\r\n        setAnimate(false);\r\n        if (!visible) {\r\n          setClosed(true);\r\n        }\r\n      }, 250);\r\n    }\r\n\r\n    if (visible) {\r\n      setClosed(false);\r\n    }\r\n\r\n    return () => {\r\n      if (!timeoutId.current) return;\r\n      clearTimeout(timeoutId.current);\r\n    };\r\n  }, [visible]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      document.body.style.overflowY = 'initial';\r\n    };\r\n  }, []);\r\n\r\n  if (!animate && !visible && closed) return null;\r\n\r\n  return <OpaqueLayerBlock animate={animate} visible={visible} />;\r\n};\r\n\r\nexport default OpaqueLayer;\r\n","import * as React from 'react';\r\nimport styled, { css } from 'styled-components';\r\nimport OpaqueLayer from './OpaqueLayer';\r\nimport zIndexes from '../../lib/styles/zIndexes';\r\nimport transitions from '../../lib/styles/transitions';\r\nimport media from '../../lib/styles/media';\r\n\r\nconst PopupBaseBlock = styled.div`\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: ${zIndexes.Popup};\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n`;\r\n\r\nconst PopupWrapper = styled.div<{ visible: boolean }>`\r\n  width: 25rem;\r\n  border-radius: 4px;\r\n  background: white;\r\n  padding: 2rem 1.5rem;\r\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.09);\r\n  ${media.small} {\r\n    width: calc(100% - 2rem);\r\n  }\r\n  ${props =>\r\n    props.visible\r\n      ? css`\r\n          animation: ${transitions.popInFromBottom} 0.4s forwards ease-in-out;\r\n        `\r\n      : css`\r\n          animation: ${transitions.popOutToBottom} 0.2s forwards ease-in-out;\r\n        `}\r\n`;\r\n\r\ninterface PopupBaseProps {\r\n  visible: boolean;\r\n}\r\n\r\nconst { useState, useEffect } = React;\r\n\r\nconst PopupBase: React.FC<PopupBaseProps> = ({ visible, children }) => {\r\n  const [closed, setClosed] = useState(true);\r\n  useEffect(() => {\r\n    let timeoutId: number | null = null;\r\n    if (visible) {\r\n      setClosed(false);\r\n    } else {\r\n      timeoutId = setTimeout(() => {\r\n        setClosed(true);\r\n      }, 200);\r\n    }\r\n    return () => {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId);\r\n      }\r\n    };\r\n  }, [visible]);\r\n\r\n  if (!visible && closed) return null;\r\n\r\n  return (\r\n    <>\r\n      <OpaqueLayer visible={visible} />\r\n      <PopupBaseBlock>\r\n        <PopupWrapper visible={visible}>{children}</PopupWrapper>\r\n      </PopupBaseBlock>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PopupBase;\r\n","import * as React from 'react';\r\nimport styled, { css } from 'styled-components';\r\nimport palette, { buttonColorMap } from '../../lib/styles/palette';\r\nimport media from '../../lib/styles/media';\r\n\r\ntype ColorType =\r\n  | 'teal'\r\n  | 'gray'\r\n  | 'darkGray'\r\n  | 'lightGray'\r\n  | 'transparent'\r\n  | 'red';\r\ntype ButtonSize = 'medium' | 'large';\r\n\r\nconst ButtonBlock = styled.button<{\r\n  color: ColorType;\r\n  inline: boolean;\r\n  size: ButtonSize;\r\n  responsive?: boolean;\r\n}>`\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n  outline: none;\r\n  border: none;\r\n  color: white;\r\n  background: ${props => buttonColorMap[props.color].background};\r\n  color: ${props => buttonColorMap[props.color].color};\r\n  &:hover,\r\n  &:focus {\r\n    background: ${props => buttonColorMap[props.color].hoverBackground};\r\n  }\r\n  border-radius: 4px;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  ${props =>\r\n    props.inline &&\r\n    css`\r\n      & + & {\r\n        margin-left: 0.5rem;\r\n      }\r\n    `}\r\n\r\n  ${props =>\r\n    props.responsive &&\r\n    css`\r\n      ${media.small} {\r\n        height: 1.5rem;\r\n        padding-left: 0.9375rem;\r\n        padding-right: 0.9375rem;\r\n        font-size: 0.75rem;\r\n      }\r\n    `}\r\n\r\n  ${props =>\r\n    props.size === 'medium' &&\r\n    css`\r\n      height: 2rem;\r\n      padding-left: 1.25rem;\r\n      padding-right: 1.25rem;\r\n      font-size: 1rem;\r\n    `}\r\n\r\n    ${props =>\r\n      props.size === 'large' &&\r\n      css`\r\n        height: 2.5rem;\r\n        padding-left: 1.125rem;\r\n        padding-right: 1.125rem;\r\n        & + & {\r\n          margin-left: 0.875rem;\r\n        }\r\n        font-size: 1.125rem;\r\n      `}\r\n\r\n    &:disabled {\r\n      cursor: not-allowed;\r\n      background: ${palette.gray3};\r\n      color: ${palette.gray5};\r\n      &:hover {\r\n        background: ${palette.gray3};\r\n        color: ${palette.gray5};\r\n      }\r\n    }\r\n`;\r\n\r\ninterface ButtonProps extends Omit<React.HTMLProps<HTMLButtonElement>, 'size'> {\r\n  color?: ColorType;\r\n  inline?: boolean;\r\n  size?: ButtonSize;\r\n  responsive?: boolean;\r\n}\r\n\r\nconst Button: React.FC<ButtonProps> = ({\r\n  children,\r\n  ref,\r\n  color = 'teal',\r\n  inline,\r\n  size = 'medium',\r\n  responsive = false,\r\n  ...rest\r\n}) => {\r\n  const htmlProps = rest as any;\r\n  return (\r\n    <ButtonBlock\r\n      color={color}\r\n      inline={inline}\r\n      size={size}\r\n      responsive={responsive}\r\n      {...htmlProps}\r\n      onClick={e => {\r\n        if (htmlProps.onClick) {\r\n          htmlProps.onClick(e);\r\n        }\r\n        (e.target as HTMLButtonElement).blur();\r\n      }}\r\n    >\r\n      {children}\r\n    </ButtonBlock>\r\n  );\r\n};\r\n\r\nexport default Button;\r\n","import * as React from 'react';\r\nimport styled from 'styled-components';\r\nimport PopupBase from './PopupBase';\r\nimport Button from './Button';\r\nimport palette from '../../lib/styles/palette';\r\n\r\nconst PopupOKCancelBlock = styled.div`\r\n  h3 {\r\n    margin: 0;\r\n    font-size: 1.5rem;\r\n    color: ${palette.gray8};\r\n    line-height: 1.5;\r\n    font-weight: bold;\r\n  }\r\n  .message {\r\n    line-height: 1.5;\r\n    font-size: 1rem;\r\n    color: ${palette.gray7};\r\n    margin-top: 1rem;\r\n    margin-bottom: 1rem;\r\n    white-space: pre-wrap;\r\n  }\r\n  .button-area {\r\n    margin-top: 2rem;\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    button + button {\r\n      margin-left: 0.75rem;\r\n    }\r\n  }\r\n`;\r\n\r\nexport interface PopupOKCancelProps {\r\n  visible: boolean;\r\n  title?: string;\r\n  onConfirm?: () => any;\r\n  onCancel?: () => any;\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst PopupOKCancel: React.FC<PopupOKCancelProps> = ({\r\n  visible,\r\n  title,\r\n  children,\r\n  onConfirm,\r\n  onCancel,\r\n}) => {\r\n  return (\r\n    <PopupBase visible={visible}>\r\n      <PopupOKCancelBlock>\r\n        {title && <h3>{title}</h3>}\r\n        <div className=\"message\">{children}</div>\r\n        <div className=\"button-area\">\r\n          {onCancel && (\r\n            <Button color=\"lightGray\" onClick={onCancel}>\r\n              취소\r\n            </Button>\r\n          )}\r\n          <Button onClick={onConfirm}>확인</Button>\r\n        </div>\r\n      </PopupOKCancelBlock>\r\n    </PopupBase>\r\n  );\r\n};\r\n\r\nexport default PopupOKCancel;\r\n","import { deprecated } from 'typesafe-actions';\r\nimport { createReducer, updateKey } from '../lib/utils';\r\n\r\nconst { createStandardAction } = deprecated;\r\n\r\nconst CHANGE_MARKDOWN = 'write/CHANGE_MARKDOWN';\r\nconst CHANGE_TITLE = 'write/CHANGE_TITLE';\r\nconst CONVERT_EDITOR_MODE = 'write/CONVERT_EDITOR_MODE';\r\nconst SET_HTML = 'write/SET_HTML';\r\nconst SET_TEXT_BODY = 'write/SET_TEXT_BODY';\r\nconst CHANGE_TAGS = 'write/CHANGE_TAGS';\r\nconst OPEN_PUBLISH = 'write/OPEN_PUBLISH';\r\nconst CLOSE_PUBLISH = 'write/CLOSE_PUBLISH';\r\nconst SET_DEFAULT_DESCRIPTION = 'write/SET_DEFAULT_DESCRIPTION';\r\nconst CHANGE_DESCRIPTION = 'write/CHANGE_DESCRIPTION';\r\nconst SET_PRIVACY = 'write/SET_PRIVACY';\r\nconst CHANGE_URL_SLUG = 'write/CHANGE_URL';\r\nconst SET_THUMBNAIL = 'write/SET_THUMBNAIL';\r\nconst TOGGLE_EDIT_SERIES = 'write/TOGGLE_EDIT_SERIES';\r\nconst SELECT_SERIES = 'write/SELECT_SERIES';\r\nconst CLEAR_EDITOR = 'write/CLEAR_EDITOR';\r\nconst PREPARE_EDIT = 'write/PREPARE_EDIT';\r\nconst SET_WRITE_POST_ID = 'write/SET_WRITE_POST_ID';\r\nconst SET_INITIAL_BODY = 'write/SET_INITIAL_BODY';\r\nconst SET_INITIAL_TITLE = 'write/SET_INITIAL_TITLE';\r\n\r\nexport const changeMarkdown = createStandardAction(CHANGE_MARKDOWN)<string>();\r\nexport const changeTitle = createStandardAction(CHANGE_TITLE)<string>();\r\nexport const convertEditorMode = createStandardAction(CONVERT_EDITOR_MODE)();\r\nexport const setHtml = createStandardAction(SET_HTML)<string>();\r\nexport const changeTags = createStandardAction(CHANGE_TAGS)<string[]>();\r\nexport const openPublish = createStandardAction(OPEN_PUBLISH)<void>();\r\nexport const closePublish = createStandardAction(CLOSE_PUBLISH)<void>();\r\nexport const setTextBody = createStandardAction(SET_TEXT_BODY)<string>();\r\nexport const setDefaultDescription = createStandardAction(\r\n  SET_DEFAULT_DESCRIPTION,\r\n)<string>();\r\nexport const changeDescription = createStandardAction(CHANGE_DESCRIPTION)<\r\n  string\r\n>();\r\nexport const setPrivacy = createStandardAction(SET_PRIVACY)<boolean>();\r\nexport const changeUrlSlug = createStandardAction(CHANGE_URL_SLUG)<string>();\r\nexport const setThumbnail = createStandardAction(SET_THUMBNAIL)<\r\n  string | null\r\n>();\r\nexport const toggleEditSeries = createStandardAction(TOGGLE_EDIT_SERIES)<\r\n  undefined\r\n>();\r\nexport const selectSeries = createStandardAction(SELECT_SERIES)<{\r\n  id: string;\r\n  name: string;\r\n} | null>();\r\nexport const clearEditor = createStandardAction(CLEAR_EDITOR)<undefined>();\r\nexport const setWritePostId = createStandardAction(SET_WRITE_POST_ID)<string>();\r\nexport const setInitialTitle = createStandardAction(SET_INITIAL_TITLE)<\r\n  string\r\n>();\r\nexport const setInitialBody = createStandardAction(SET_INITIAL_BODY)<string>();\r\n\r\nexport type PrepareEditPayload = {\r\n  id: string;\r\n  title: string;\r\n  body: string;\r\n  tags: string[];\r\n  description: string;\r\n  urlSlug: string;\r\n  series: {\r\n    name: string;\r\n    id: string;\r\n  } | null;\r\n  isPrivate: boolean;\r\n  isMarkdown: boolean;\r\n  isTemp?: boolean;\r\n  thumbnail: string | null;\r\n};\r\n\r\nexport const prepareEdit = createStandardAction(PREPARE_EDIT)<\r\n  PrepareEditPayload\r\n>();\r\n\r\ntype ChangeMarkdown = ReturnType<typeof changeMarkdown>;\r\ntype ChangeTitle = ReturnType<typeof changeTitle>;\r\ntype SetHtml = ReturnType<typeof setHtml>;\r\ntype ChangeTags = ReturnType<typeof changeTags>;\r\ntype OpenPublish = ReturnType<typeof openPublish>;\r\ntype ClosePublish = ReturnType<typeof closePublish>;\r\ntype SetTextBody = ReturnType<typeof setTextBody>;\r\ntype SetDefaultDescription = ReturnType<typeof setDefaultDescription>;\r\ntype ChangeDescription = ReturnType<typeof changeDescription>;\r\ntype SetPrivacy = ReturnType<typeof setPrivacy>;\r\ntype ChangeUrlSlug = ReturnType<typeof changeUrlSlug>;\r\ntype SetThumbnail = ReturnType<typeof setThumbnail>;\r\ntype SelectSeries = ReturnType<typeof selectSeries>;\r\ntype ClearEditor = ReturnType<typeof clearEditor>;\r\ntype PrepareEdit = ReturnType<typeof prepareEdit>;\r\ntype SetWritePostId = ReturnType<typeof setWritePostId>;\r\ntype SetInitialBody = ReturnType<typeof setInitialBody>;\r\ntype SetInitialTitle = ReturnType<typeof setInitialTitle>;\r\n\r\nexport enum WriteMode {\r\n  MARKDOWN = 'MARKDOWN',\r\n  WYSIWYG = 'WYSIWYG',\r\n}\r\n\r\nexport type WriteState = {\r\n  mode: WriteMode;\r\n  markdown: string;\r\n  title: string;\r\n  html: string;\r\n  tags: string[];\r\n  publish: boolean; // publish screen visibility\r\n  textBody: string;\r\n  defaultDescription: string;\r\n  description: string;\r\n  isPrivate: boolean;\r\n  urlSlug: string;\r\n  thumbnail: string | null;\r\n  editSeries: boolean;\r\n  selectedSeries: {\r\n    id: string;\r\n    name: string;\r\n  } | null;\r\n  postId: null | string;\r\n  isTemp: boolean;\r\n  initialTitle: string;\r\n  initialBody: string;\r\n};\r\n\r\nconst initialState: WriteState = {\r\n  mode: WriteMode.MARKDOWN,\r\n  markdown: '',\r\n  title: '',\r\n  html: '',\r\n  tags: [],\r\n  publish: false,\r\n  textBody: '',\r\n  defaultDescription: '',\r\n  description: '',\r\n  isPrivate: false,\r\n  urlSlug: '',\r\n  thumbnail: null,\r\n  editSeries: false,\r\n  selectedSeries: null,\r\n  postId: null,\r\n  isTemp: false,\r\n  initialTitle: '',\r\n  initialBody: '',\r\n};\r\n\r\nconst write = createReducer(\r\n  {\r\n    [CHANGE_MARKDOWN]: (state, action: ChangeMarkdown) =>\r\n      updateKey(state, 'markdown', action.payload),\r\n    [CHANGE_TITLE]: (state, action: ChangeTitle) =>\r\n      updateKey(state, 'title', action.payload),\r\n    [CONVERT_EDITOR_MODE]: state =>\r\n      updateKey(\r\n        state,\r\n        'mode',\r\n        state.mode === WriteMode.MARKDOWN\r\n          ? WriteMode.WYSIWYG\r\n          : WriteMode.MARKDOWN,\r\n      ),\r\n    [SET_HTML]: (state, action: SetHtml) =>\r\n      updateKey(state, 'html', action.payload),\r\n    [CHANGE_TAGS]: (state, action: ChangeTags) =>\r\n      updateKey(state, 'tags', action.payload),\r\n    [OPEN_PUBLISH]: state => updateKey(state, 'publish', true),\r\n    [CLOSE_PUBLISH]: state => updateKey(state, 'publish', false),\r\n    [SET_TEXT_BODY]: (state, { payload: textBody }: SetTextBody) =>\r\n      updateKey(state, 'textBody', textBody),\r\n    [SET_DEFAULT_DESCRIPTION]: (\r\n      state,\r\n      { payload: defaultDescription }: SetDefaultDescription,\r\n    ) => updateKey(state, 'defaultDescription', defaultDescription),\r\n    [CHANGE_DESCRIPTION]: (\r\n      state,\r\n      { payload: description }: ChangeDescription,\r\n    ) => updateKey(state, 'description', description.slice(0, 150)),\r\n    [SET_PRIVACY]: (state, { payload: isPrivate }: SetPrivacy) =>\r\n      updateKey(state, 'isPrivate', isPrivate),\r\n    [CHANGE_URL_SLUG]: (state, { payload: urlSlug }: ChangeUrlSlug) =>\r\n      updateKey(state, 'urlSlug', urlSlug),\r\n    [SET_THUMBNAIL]: (state, { payload: thumbnail }: SetThumbnail) =>\r\n      updateKey(state, 'thumbnail', thumbnail),\r\n    [TOGGLE_EDIT_SERIES]: state =>\r\n      updateKey(state, 'editSeries', !state.editSeries),\r\n    [SELECT_SERIES]: (state, action: SelectSeries) =>\r\n      updateKey(state, 'selectedSeries', action.payload),\r\n    [CLEAR_EDITOR]: () => initialState,\r\n    [PREPARE_EDIT]: (state, { payload }: PrepareEdit) => {\r\n      const {\r\n        isMarkdown,\r\n        body,\r\n        title,\r\n        tags,\r\n        description,\r\n        urlSlug,\r\n        series,\r\n        id,\r\n        isPrivate,\r\n        isTemp,\r\n        thumbnail,\r\n      } = payload;\r\n      const key = isMarkdown ? 'markdown' : 'html';\r\n      return {\r\n        ...state,\r\n        title,\r\n        tags,\r\n        description: description.slice(0, 150),\r\n        urlSlug,\r\n        isPrivate,\r\n        isTemp: isTemp || false,\r\n        mode: isMarkdown ? WriteMode.MARKDOWN : WriteMode.WYSIWYG,\r\n        [key]: body,\r\n        selectedSeries: series,\r\n        postId: id,\r\n        initialBody: body,\r\n        initialTitle: title,\r\n        thumbnail,\r\n      };\r\n    },\r\n    [SET_WRITE_POST_ID]: (state, action: SetWritePostId) => ({\r\n      ...state,\r\n      postId: action.payload,\r\n      isTemp: true,\r\n    }),\r\n    [SET_INITIAL_BODY]: (state, action: SetInitialBody) =>\r\n      updateKey(state, 'initialBody', action.payload),\r\n    [SET_INITIAL_TITLE]: (state, action: SetInitialTitle) => ({\r\n      ...state,\r\n      title: action.payload,\r\n      initialTitle: action.payload,\r\n    }),\r\n  },\r\n  initialState,\r\n);\r\n\r\nexport default write;\r\n","import * as React from 'react';\r\nimport PopupOKCancel from '../common/PopupOKCancel';\r\nimport { WriteMode } from '../../modules/write';\r\n\r\nexport interface AskChangeEditorProps {\r\n  visible: boolean;\r\n  onCancel: () => void;\r\n  onConfirm: () => void;\r\n  convertTo: WriteMode;\r\n}\r\n\r\nconst AskChangeEditor: React.FC<AskChangeEditorProps> = ({\r\n  visible,\r\n  onCancel,\r\n  onConfirm,\r\n  convertTo,\r\n}) => {\r\n  if (convertTo === WriteMode.MARKDOWN) {\r\n    return (\r\n      <PopupOKCancel\r\n        visible={visible}\r\n        title=\"마크다운 에디터로 전환\"\r\n        onCancel={onCancel}\r\n        onConfirm={onConfirm}\r\n      >\r\n        에디터 모드를 전환하시겠습니까?\r\n        {/* <br />\r\n        확인을 누르시면 지금까지 입력하신 모든 내용이 마크다운 포맷으료\r\n        변환됩니다.\r\n        <br />\r\n        <br />\r\n        <div style={{ fontSize: '0.875rem' }}>\r\n          <b>주의:</b> 변환 후 코드블록의 언어 타입을 수동으로 입력해주셔야\r\n          합니다.\r\n        </div> */}\r\n      </PopupOKCancel>\r\n    );\r\n  }\r\n  return (\r\n    <PopupOKCancel\r\n      visible={visible}\r\n      title=\"쉬운 에디터로 전환\"\r\n      onCancel={onCancel}\r\n      onConfirm={onConfirm}\r\n    >\r\n      에디터 모드를 전환하시겠습니까?\r\n    </PopupOKCancel>\r\n  );\r\n};\r\n\r\nexport default AskChangeEditor;\r\n","export default function detectIOS() {\r\n  if (process.env.REACT_APP_SSR === 'enabled') return false;\r\n\r\n  // checkAgent for Chrome Developer Menu\r\n  const checkAgent =\r\n    /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n\r\n  const checkPlatform =\r\n    (/iPad|iPhone|iPod/.test(navigator.platform) ||\r\n      (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1)) &&\r\n    !window.MSStream;\r\n\r\n  return checkAgent || checkPlatform;\r\n}\r\n","import * as React from 'react';\r\nimport styled from 'styled-components';\r\nimport 'codemirror/lib/codemirror.css';\r\n// import 'codemirror/theme/dracula.css';\r\nimport CodeMirror, { EditorFromTextArea } from 'codemirror';\r\nimport TitleTextarea, { TitleTextareaForSSR } from './TitleTextarea';\r\nimport '../common/atom-one-light.css';\r\nimport palette from '../../lib/styles/palette';\r\nimport Toolbar from './Toolbar';\r\nimport AddLink from './AddLink';\r\nimport { detectJSDOM, ssrEnabled } from '../../lib/utils';\r\nimport AskChangeEditor from './AskChangeEditor';\r\nimport { WriteMode } from '../../modules/write';\r\nimport zIndexes from '../../lib/styles/zIndexes';\r\nimport { useSpring, animated } from 'react-spring';\r\nimport media, { mediaQuery } from '../../lib/styles/media';\r\nimport detectIOS from '../../lib/detectIOS';\r\nrequire('codemirror/mode/markdown/markdown');\r\nrequire('codemirror/mode/javascript/javascript');\r\nrequire('codemirror/mode/jsx/jsx');\r\nrequire('codemirror/addon/display/placeholder');\r\n\r\nexport interface MarkdownEditorProps {\r\n  onChangeMarkdown: (markdown: string) => void;\r\n  onChangeTitle: (title: string) => void;\r\n  onConvert: (markdown: string) => void;\r\n  title: string;\r\n  markdown: string;\r\n  tagInput: React.ReactNode;\r\n  footer: React.ReactNode;\r\n  // onUpload: () => void;\r\n  // lastUploadedImage: string | null;\r\n  initialBody: string;\r\n}\r\n\r\ntype MarkdownEditorState = {\r\n  addLink: {\r\n    top: number | null;\r\n    bottom: number | null;\r\n    left: number;\r\n    visible: boolean;\r\n    stickToRight: boolean;\r\n  };\r\n  askChangeEditor: boolean;\r\n  clientWidth: number;\r\n  hideUpper: boolean;\r\n  appleCursorPos: number;\r\n};\r\n\r\ntype CheckerKey = keyof typeof checker;\r\n\r\nconst checkEmbed = (text: string) => {\r\n  const keys = Object.keys(checker) as CheckerKey[];\r\n  for (let i = 0; i < keys.length; i += 1) {\r\n    const key = keys[i];\r\n    const fn = checker[keys[i]];\r\n    const code = fn(text);\r\n    if (code) {\r\n      return `!${key}[${code}]`;\r\n    }\r\n  }\r\n  return null;\r\n};\r\n\r\nconst removeHeading = (text: string) => {\r\n  return text.replace(/#{1,6} /, '');\r\n};\r\n\r\nfunction WriterHead({\r\n  hide,\r\n  children,\r\n}: {\r\n  hide: boolean;\r\n  children: React.ReactNode;\r\n}) {\r\n  const screenHeight =\r\n    (typeof window !== 'undefined' && window.screen.height) || 508;\r\n\r\n  const springStyle = useSpring({\r\n    maxHeight: hide ? 0 : screenHeight * 0.5,\r\n    opacity: hide ? 0 : 1,\r\n    config: {\r\n      duration: 300,\r\n    },\r\n  });\r\n  return (\r\n    <animated.div style={springStyle}>\r\n      <PaddingWrapper>{children}</PaddingWrapper>\r\n    </animated.div>\r\n  );\r\n}\r\n\r\nexport default class WriteMarkdownEditor extends React.Component<\r\n  MarkdownEditorProps,\r\n  MarkdownEditorState\r\n> {\r\n  block = React.createRef<HTMLDivElement>();\r\n  toolbarElement = React.createRef<HTMLDivElement>();\r\n  editorElement = React.createRef<HTMLTextAreaElement>();\r\n  appleEditorElement = React.createRef<HTMLTextAreaElement>();\r\n\r\n  toolbarTop = 0;\r\n  state = {\r\n    addLink: {\r\n      top: 0,\r\n      bottom: 0,\r\n      left: 0,\r\n      visible: false,\r\n      stickToRight: false,\r\n    },\r\n    askChangeEditor: false,\r\n    clientWidth: 0,\r\n    hideUpper: false,\r\n    appleCursorPos: 0,\r\n  };\r\n  codemirror: EditorFromTextArea | null = null;\r\n  ignore = false;\r\n  isIOS = detectIOS();\r\n\r\n  initialize = () => {\r\n    if (this.isIOS) return;\r\n    if (!this.editorElement.current) return;\r\n    this.codemirror = CodeMirror.fromTextArea(this.editorElement.current, {\r\n      mode: 'markdown',\r\n      theme: 'one-light',\r\n      placeholder: '당신의 이야기를 적어보세요...',\r\n      // viewportMargin: Infinity,\r\n      lineWrapping: true,\r\n    });\r\n\r\n    if (detectJSDOM()) return;\r\n    this.codemirror.setValue(this.props.initialBody);\r\n    this.codemirror.on('change', cm => {\r\n      this.props.onChangeMarkdown(cm.getValue());\r\n      this.stickToBottomIfNeeded();\r\n      const doc = cm.getDoc();\r\n\r\n      // scroll to bottom when editing last 5\r\n      const { line } = doc.getCursor();\r\n      const last = doc.lastLine();\r\n      if (last - line < 5) {\r\n        const preview = document.getElementById('preview');\r\n        if (!preview) return;\r\n        preview.scrollTop = preview.scrollHeight;\r\n      }\r\n    });\r\n\r\n    this.codemirror.on('scroll', cm => {\r\n      const info = cm.getScrollInfo();\r\n\r\n      if (info.top > 0 && info.height > window.screen.height) {\r\n        this.setState({ hideUpper: true });\r\n      } else {\r\n        this.setState({ hideUpper: false });\r\n      }\r\n    });\r\n\r\n    this.codemirror.on('dragover', (cm, e) => {\r\n      if (e.dataTransfer) {\r\n        e.dataTransfer.dropEffect = 'copy';\r\n      }\r\n    });\r\n\r\n    this.codemirror.on('mousewheel', cm => {\r\n      console.log(cm.getScrollInfo());\r\n    });\r\n\r\n    this.codemirror.on('paste', ((editor: any, e: any) => {\r\n      const clipboardData = e.clipboardData || e.originalEvent.clipboardData;\r\n      if (!clipboardData) return;\r\n\r\n      // replace text for embedding youtube, twitte, etc\r\n      const text = clipboardData.getData('Text');\r\n      const check = checkEmbed(text);\r\n      if (check) {\r\n        const selection = editor.getSelection();\r\n        e.preventDefault();\r\n        if (selection.length > 0) {\r\n          editor.replaceSelection(check);\r\n        } else {\r\n          const doc = editor.getDoc();\r\n          const cursor = doc.getCursor();\r\n          const pos = {\r\n            line: cursor.line,\r\n            ch: cursor.ch,\r\n          };\r\n          doc.replaceRange(check, pos);\r\n        }\r\n        return;\r\n      }\r\n\r\n      const { items } = clipboardData;\r\n      if (!items) return;\r\n      if (items.length !== 2) return;\r\n      if (items[1].kind === 'file') {\r\n        e.preventDefault();\r\n      }\r\n    }) as any);\r\n  };\r\n\r\n  stickToBottomIfNeeded = () => {\r\n    if (!this.block.current) return;\r\n    const { scrollHeight, scrollTop, clientHeight } = this.block.current;\r\n    const scrollBottom = scrollHeight - scrollTop - clientHeight;\r\n    if (scrollBottom < 192) {\r\n      this.block.current.scrollTo(0, scrollHeight);\r\n    }\r\n  };\r\n\r\n  handleResize = () => {\r\n    if (this.block.current) {\r\n      this.setState({\r\n        clientWidth: this.block.current.clientWidth,\r\n      });\r\n    }\r\n  };\r\n\r\n  addImageToEditor = (image: string) => {\r\n    if (this.isIOS) {\r\n      const textarea = this.appleEditorElement.current;\r\n      if (!textarea) return;\r\n      const { markdown, onChangeMarkdown } = this.props;\r\n\r\n      const cursorPos = textarea.selectionEnd;\r\n      const textBefore = markdown.slice(0, cursorPos);\r\n      const textAfter = markdown.slice(cursorPos, markdown.length);\r\n      const imageMarkdown = `![](${encodeURI(image)})`;\r\n      const nextMarkdown = `${textBefore}${imageMarkdown}${textAfter}`;\r\n      onChangeMarkdown(nextMarkdown);\r\n      setTimeout(() => {\r\n        textarea.focus();\r\n        const nextCursorPos = cursorPos + imageMarkdown.length;\r\n        textarea.selectionStart = nextCursorPos;\r\n        textarea.selectionEnd = nextCursorPos;\r\n      }, 0);\r\n      return;\r\n    }\r\n    if (!this.codemirror) return;\r\n    this.codemirror.getDoc().replaceSelection(`![](${encodeURI(image)})`);\r\n  };\r\n\r\n  componentDidUpdate(prevProps: MarkdownEditorProps) {\r\n    // const { /* lastUploadedImage, */ initialBody } = this.props;\r\n    // if (initialBody !== prevProps.initialBody) {\r\n    //   if (!this.codemirror) return;\r\n    //   if (this.codemirror.getValue() === this.props.initialBody) return;\r\n    //   this.codemirror.setValue(this.props.initialBody);\r\n    // }\r\n    // if (\r\n    //   lastUploadedImage &&\r\n    //   prevProps.lastUploadedImage !== lastUploadedImage\r\n    // ) {\r\n    //   this.addImageToEditor(lastUploadedImage);\r\n    // }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.initialize();\r\n    setTimeout(() => {\r\n      if (this.toolbarElement.current) {\r\n        this.toolbarTop = this.toolbarElement.current.getBoundingClientRect().top;\r\n      }\r\n    });\r\n    if (this.block.current) {\r\n      this.setState({\r\n        clientWidth: this.block.current.clientWidth,\r\n      });\r\n    }\r\n    window.addEventListener('resize', this.handleResize);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('resize', this.handleResize);\r\n  }\r\n\r\n  handleOpenAddLink = () => {\r\n    if (!this.codemirror) return;\r\n    const doc = this.codemirror.getDoc();\r\n    const cursor = doc.getCursor();\r\n    const cursorPos = this.codemirror.cursorCoords(cursor);\r\n    if (!this.block.current) return;\r\n    const stickToRight = cursorPos.left > this.block.current.clientWidth - 341;\r\n    const calculatedTop =\r\n      this.block.current.scrollTop +\r\n      cursorPos.top +\r\n      this.codemirror.defaultTextHeight() / 2 +\r\n      1;\r\n\r\n    const isAtBottom = calculatedTop + 173 > this.block.current?.clientHeight;\r\n    const pos = isAtBottom\r\n      ? { top: null, bottom: 64 }\r\n      : { top: calculatedTop, bottom: null };\r\n    this.setState({\r\n      addLink: {\r\n        visible: true,\r\n        ...pos,\r\n        left: cursorPos.left,\r\n        stickToRight,\r\n      },\r\n    });\r\n  };\r\n\r\n  handleConfirmAddLink = (link: string) => {\r\n    // 링크삽입하는 내용\r\n    this.setState({\r\n      addLink: {\r\n        ...this.state.addLink,\r\n        visible: false,\r\n      },\r\n    });\r\n    if (!this.codemirror) return;\r\n    const doc = this.codemirror.getDoc();\r\n    const selection = doc.getSelection();\r\n    const cursor = doc.getCursor('end');\r\n    this.codemirror.focus();\r\n    if (selection.length === 0) {\r\n      doc.replaceSelection(`[링크텍스트](${link})`);\r\n      doc.setSelection(\r\n        {\r\n          line: cursor.line,\r\n          ch: cursor.ch + 1,\r\n        },\r\n        {\r\n          line: cursor.line,\r\n          ch: cursor.ch + 6,\r\n        },\r\n      );\r\n      return;\r\n    }\r\n    doc.replaceSelection(`[${selection}](${link})`);\r\n    doc.setCursor({\r\n      line: cursor.line,\r\n      ch: cursor.ch + link.length + 4,\r\n    });\r\n  };\r\n\r\n  handleCancelAddLink = () => {\r\n    this.setState({\r\n      addLink: {\r\n        ...this.state.addLink,\r\n        visible: false,\r\n      },\r\n    });\r\n  };\r\n\r\n  handleToolbarClickForApple = (mode: string) => {\r\n    if (!this.appleEditorElement.current) return;\r\n    const cursorPos = this.appleEditorElement.current?.selectionStart || 0;\r\n    const { markdown, onChangeMarkdown } = this.props;\r\n    const sliced = markdown.slice(0, cursorPos);\r\n\r\n    // const lineNumber = sliced.split('\\n').length;\r\n    const lastNewLineIndex = sliced.lastIndexOf('\\n');\r\n    const textBefore = sliced.slice(0, lastNewLineIndex + 1);\r\n    const textAfter = markdown.slice(lastNewLineIndex + 1, markdown.length);\r\n    let currentNewLineIndex = textAfter.indexOf('\\n');\r\n    if (currentNewLineIndex === -1) currentNewLineIndex = textAfter.length;\r\n\r\n    const lineText = textAfter.slice(0, currentNewLineIndex);\r\n    const textBelowCurrentLine = textAfter.slice(\r\n      currentNewLineIndex,\r\n      textAfter.length,\r\n    );\r\n\r\n    const setCursorPos = (pos: number) => {\r\n      setTimeout(() => {\r\n        this.appleEditorElement.current!.selectionStart = pos;\r\n        this.appleEditorElement.current!.selectionEnd = pos;\r\n      }, 0);\r\n    };\r\n\r\n    console.log({ lineText });\r\n    const handlers: {\r\n      [key: string]: () => void;\r\n    } = {\r\n      heading1: () => {\r\n        const applied = /^# /.test(lineText);\r\n        if (applied) {\r\n          const replacedLine = lineText.replace(/^# /, '');\r\n          onChangeMarkdown(\r\n            `${textBefore}${replacedLine}${textBelowCurrentLine}`,\r\n          );\r\n          setCursorPos(cursorPos - 2);\r\n          return;\r\n        }\r\n\r\n        const anotherHeading = /^#{1,4} /.test(lineText);\r\n        if (anotherHeading) {\r\n          const replacedLine = lineText.replace(/^#{1,4} /, '# ');\r\n          onChangeMarkdown(\r\n            `${textBefore}${replacedLine}${textBelowCurrentLine}`,\r\n          );\r\n          const posDiff = replacedLine.length - lineText.length;\r\n          setCursorPos(cursorPos + posDiff);\r\n\r\n          return;\r\n        }\r\n\r\n        onChangeMarkdown(`${textBefore}# ${textAfter}`);\r\n        // this.appleEditorElement.current!.selectionStart = cursorPos;\r\n        setCursorPos(cursorPos + 2);\r\n      },\r\n      heading2: () => {\r\n        const applied = /^## /.test(lineText);\r\n        if (applied) {\r\n          const replacedLine = lineText.replace(/^## /, '');\r\n          onChangeMarkdown(\r\n            `${textBefore}${replacedLine}${textBelowCurrentLine}`,\r\n          );\r\n          setCursorPos(cursorPos - 3);\r\n\r\n          return;\r\n        }\r\n\r\n        const anotherHeading = /^#{1,4} /.test(lineText);\r\n        if (anotherHeading) {\r\n          const replacedLine = lineText.replace(/^#{1,4} /, '## ');\r\n          onChangeMarkdown(\r\n            `${textBefore}${replacedLine}${textBelowCurrentLine}`,\r\n          );\r\n          const posDiff = replacedLine.length - lineText.length;\r\n          setCursorPos(cursorPos + posDiff);\r\n          return;\r\n        }\r\n\r\n        onChangeMarkdown(`${textBefore}## ${textAfter}`);\r\n        setCursorPos(cursorPos + 3);\r\n      },\r\n      heading3: () => {\r\n        const applied = /^### /.test(lineText);\r\n        if (applied) {\r\n          const replacedLine = lineText.replace(/^### /, '');\r\n          onChangeMarkdown(\r\n            `${textBefore}${replacedLine}${textBelowCurrentLine}`,\r\n          );\r\n          setCursorPos(cursorPos - 4);\r\n\r\n          return;\r\n        }\r\n\r\n        const anotherHeading = /^#{1,4} /.test(lineText);\r\n        if (anotherHeading) {\r\n          const replacedLine = lineText.replace(/^#{1,4} /, '### ');\r\n          onChangeMarkdown(\r\n            `${textBefore}${replacedLine}${textBelowCurrentLine}`,\r\n          );\r\n          const posDiff = replacedLine.length - lineText.length;\r\n          setCursorPos(cursorPos + posDiff);\r\n          return;\r\n        }\r\n\r\n        onChangeMarkdown(`${textBefore}### ${textAfter}`);\r\n        setCursorPos(cursorPos + 4);\r\n      },\r\n      heading4: () => {\r\n        const applied = /^#### /.test(lineText);\r\n        if (applied) {\r\n          const replacedLine = lineText.replace(/^#### /, '');\r\n          onChangeMarkdown(\r\n            `${textBefore}${replacedLine}${textBelowCurrentLine}`,\r\n          );\r\n          setCursorPos(cursorPos - 5);\r\n\r\n          return;\r\n        }\r\n\r\n        const anotherHeading = /^#{1,4} /.test(lineText);\r\n        if (anotherHeading) {\r\n          const replacedLine = lineText.replace(/^#{1,4} /, '#### ');\r\n          onChangeMarkdown(\r\n            `${textBefore}${replacedLine}${textBelowCurrentLine}`,\r\n          );\r\n          const posDiff = replacedLine.length - lineText.length;\r\n          setCursorPos(cursorPos + posDiff);\r\n          return;\r\n        }\r\n\r\n        onChangeMarkdown(`${textBefore}#### ${textAfter}`);\r\n        setCursorPos(cursorPos + 5);\r\n      },\r\n      image: () => {\r\n        // this.props.onUpload();\r\n      },\r\n    };\r\n\r\n    this.appleEditorElement.current!.focus();\r\n    handlers[mode]();\r\n\r\n    // const handlers: {\r\n    //   [key: string]: Function;\r\n    // } = {\r\n    //   ...[1, 2, 3, 4] // creates handlers for heading1, heading2, heading3, heading4\r\n    //     .map(number => () => {\r\n    //       // create handler function\r\n    //       const characters = '#'.repeat(number);\r\n    //       const plain = removeHeading(line);\r\n    //       selectWholeLine();\r\n    //       doc.replaceSelection(`${characters} ${plain}`);\r\n    //     })\r\n    //     .reduce((headingHandlers, handler, index) => {\r\n    //       // reduce into handlers object\r\n    //       return Object.assign(headingHandlers, {\r\n    //         [`heading${index + 1}`]: handler,\r\n    //       });\r\n    //     }, {}),\r\n    // };\r\n  };\r\n\r\n  handleToolbarClick = (mode: string) => {\r\n    const codemirror = this.codemirror;\r\n    if (this.isIOS) return this.handleToolbarClickForApple(mode);\r\n\r\n    if (!codemirror) return;\r\n    const doc = codemirror.getDoc();\r\n\r\n    const cursor = doc.getCursor();\r\n    const selection = {\r\n      start: doc.getCursor('start'),\r\n      end: doc.getCursor('end'),\r\n    };\r\n\r\n    const line = doc.getLine(cursor.line);\r\n\r\n    const selectWholeLine = () => {\r\n      doc.setSelection(\r\n        {\r\n          line: cursor.line,\r\n          ch: 0,\r\n        },\r\n        {\r\n          line: cursor.line,\r\n          ch: line.length,\r\n        },\r\n      );\r\n    };\r\n\r\n    const handlers: {\r\n      [key: string]: Function;\r\n    } = {\r\n      ...[1, 2, 3, 4] // creates handlers for heading1, heading2, heading3, heading4\r\n        .map(number => () => {\r\n          // create handler function\r\n          const characters = '#'.repeat(number);\r\n          const plain = removeHeading(line);\r\n          selectWholeLine();\r\n          doc.replaceSelection(`${characters} ${plain}`);\r\n        })\r\n        .reduce((headingHandlers, handler, index) => {\r\n          // reduce into handlers object\r\n          return Object.assign(headingHandlers, {\r\n            [`heading${index + 1}`]: handler,\r\n          });\r\n        }, {}),\r\n      bold: () => {\r\n        const selected = doc.getSelection();\r\n        if (selected === '텍스트') {\r\n          const isBold = /\\*\\*(.*)\\*\\*/.test(\r\n            doc.getRange(\r\n              { line: selection.start.line, ch: selection.start.ch - 2 },\r\n              { line: selection.end.line, ch: selection.end.ch + 2 },\r\n            ),\r\n          );\r\n\r\n          if (isBold) {\r\n            doc.setSelection(\r\n              { line: selection.start.line, ch: selection.start.ch - 2 },\r\n              { line: selection.end.line, ch: selection.end.ch + 2 },\r\n            );\r\n            doc.replaceSelection('텍스트');\r\n            doc.setSelection(\r\n              { line: selection.start.line, ch: selection.start.ch - 2 },\r\n              { line: selection.end.line, ch: selection.end.ch - 2 },\r\n            );\r\n            return;\r\n          }\r\n        }\r\n        if (/\\*\\*(.*)\\*\\*/.test(selected)) {\r\n          // matches **string**\r\n          doc.replaceSelection(selected.replace(/\\*\\*/g, ''));\r\n          doc.setSelection(\r\n            {\r\n              line: selection.start.line,\r\n              ch: selection.start.ch,\r\n            },\r\n            { line: selection.end.line, ch: selection.end.ch - 4 },\r\n          );\r\n          return;\r\n        }\r\n        if (selected.length > 0) {\r\n          doc.replaceSelection(`**${selected}**`);\r\n          doc.setSelection(\r\n            {\r\n              line: selection.start.line,\r\n              ch: selection.start.ch,\r\n            },\r\n            { line: selection.end.line, ch: selection.end.ch + 4 },\r\n          );\r\n          return;\r\n        }\r\n        doc.replaceSelection('**텍스트**');\r\n        doc.setSelection(\r\n          {\r\n            line: cursor.line,\r\n            ch: cursor.ch + 2,\r\n          },\r\n          {\r\n            line: cursor.line,\r\n            ch: cursor.ch + 5,\r\n          },\r\n        );\r\n      },\r\n      italic: () => {\r\n        let selected = doc.getSelection();\r\n\r\n        if (selected.length === 0) {\r\n          doc.replaceSelection(`_텍스트_`);\r\n          doc.setSelection(\r\n            {\r\n              line: cursor.line,\r\n              ch: cursor.ch + 1,\r\n            },\r\n            {\r\n              line: cursor.line,\r\n              ch: cursor.ch + 4,\r\n            },\r\n          );\r\n          return;\r\n        }\r\n\r\n        if (selected === '텍스트') {\r\n          const selectLeftAndRight = doc.getRange(\r\n            {\r\n              line: selection.start.line,\r\n              ch: selection.start.ch - 1,\r\n            },\r\n            {\r\n              line: selection.end.line,\r\n              ch: selection.end.ch + 1,\r\n            },\r\n          );\r\n          if (/_(.*)_/.test(selectLeftAndRight)) {\r\n            selected = selectLeftAndRight;\r\n            doc.setSelection(\r\n              {\r\n                line: selection.start.line,\r\n                ch: selection.start.ch - 1,\r\n              },\r\n              {\r\n                line: selection.end.line,\r\n                ch: selection.end.ch + 1,\r\n              },\r\n            );\r\n            selection.start = {\r\n              line: selection.start.line,\r\n              ch: selection.start.ch - 1,\r\n            };\r\n            selection.end = {\r\n              line: selection.end.line,\r\n              ch: selection.end.ch + 1,\r\n            };\r\n          }\r\n        }\r\n\r\n        if (/_(.*)_/.test(selected)) {\r\n          const plain = selected\r\n            .replace(/^_/, '') // remove starting _\r\n            .replace(/_$/, ''); // remove ending _\r\n          doc.replaceSelection(plain);\r\n          doc.setSelection(\r\n            {\r\n              line: selection.start.line,\r\n              ch: selection.start.ch,\r\n            },\r\n            { line: selection.end.line, ch: selection.end.ch - 2 },\r\n          );\r\n          return;\r\n        }\r\n        if (selected.length > 0) {\r\n          doc.replaceSelection(`_${selected}_`);\r\n          doc.setSelection(\r\n            {\r\n              line: selection.start.line,\r\n              ch: selection.start.ch,\r\n            },\r\n            { line: selection.end.line, ch: selection.end.ch + 2 },\r\n          );\r\n        }\r\n      },\r\n      strike: () => {\r\n        let selected = doc.getSelection();\r\n\r\n        if (selected.length === 0) {\r\n          doc.replaceSelection(`~~텍스트~~`);\r\n          doc.setSelection(\r\n            {\r\n              line: cursor.line,\r\n              ch: cursor.ch + 2,\r\n            },\r\n            {\r\n              line: cursor.line,\r\n              ch: cursor.ch + 5,\r\n            },\r\n          );\r\n          return;\r\n        }\r\n\r\n        if (selected === '텍스트') {\r\n          const selectLeftAndRight = doc.getRange(\r\n            {\r\n              line: selection.start.line,\r\n              ch: selection.start.ch - 2,\r\n            },\r\n            {\r\n              line: selection.end.line,\r\n              ch: selection.end.ch + 2,\r\n            },\r\n          );\r\n          if (/~~(.*)~~/.test(selectLeftAndRight)) {\r\n            selected = selectLeftAndRight;\r\n            doc.setSelection(\r\n              {\r\n                line: selection.start.line,\r\n                ch: selection.start.ch - 2,\r\n              },\r\n              {\r\n                line: selection.end.line,\r\n                ch: selection.end.ch + 2,\r\n              },\r\n            );\r\n            selection.start = {\r\n              line: selection.start.line,\r\n              ch: selection.start.ch - 2,\r\n            };\r\n            selection.end = {\r\n              line: selection.end.line,\r\n              ch: selection.end.ch + 2,\r\n            };\r\n          }\r\n        }\r\n\r\n        if (/~~(.*)~~/.test(selected)) {\r\n          const plain = selected\r\n            .replace(/^~~/, '') // remove starting ~~\r\n            .replace(/~~$/, ''); // remove ending ~~\r\n          doc.replaceSelection(plain);\r\n          doc.setSelection(\r\n            {\r\n              line: selection.start.line,\r\n              ch: selection.start.ch,\r\n            },\r\n            { line: selection.end.line, ch: selection.end.ch - 4 },\r\n          );\r\n          return;\r\n        }\r\n        if (selected.length > 0) {\r\n          doc.replaceSelection(`~~${selected}~~`);\r\n          doc.setSelection(\r\n            {\r\n              line: selection.start.line,\r\n              ch: selection.start.ch,\r\n            },\r\n            { line: selection.end.line, ch: selection.end.ch + 4 },\r\n          );\r\n        }\r\n      },\r\n      blockquote: () => {\r\n        const matches = /^> /.test(line);\r\n        doc.setSelection(\r\n          { line: cursor.line, ch: 0 },\r\n          { line: cursor.line, ch: line.length },\r\n        );\r\n        if (matches) {\r\n          doc.replaceSelection(line.replace(/^> /, ''));\r\n          doc.setCursor({\r\n            line: cursor.line,\r\n            ch: cursor.ch - 2,\r\n          });\r\n        } else {\r\n          doc.replaceSelection(`> ${line}`);\r\n          doc.setCursor({\r\n            line: cursor.line,\r\n            ch: cursor.ch + 2,\r\n          });\r\n        }\r\n      },\r\n      link: () => {\r\n        this.handleOpenAddLink();\r\n      },\r\n      image: () => {\r\n        // this.props.onUpload();\r\n      },\r\n      codeblock: () => {\r\n        const selected = doc.getSelection();\r\n        if (selected.length === 0) {\r\n          doc.replaceSelection('```\\n코드를 입력하세요\\n```');\r\n          doc.setSelection(\r\n            {\r\n              line: cursor.line + 1,\r\n              ch: 0,\r\n            },\r\n            {\r\n              line: cursor.line + 1,\r\n              ch: 9,\r\n            },\r\n          );\r\n          return;\r\n        }\r\n        doc.replaceSelection(`\\`\\`\\`\r\n${selected}\r\n\\`\\`\\``);\r\n      },\r\n    };\r\n\r\n    const handler = handlers[mode];\r\n    if (!handler) return;\r\n\r\n    handler();\r\n    codemirror.focus();\r\n  };\r\n\r\n  handleTitleChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n    this.props.onChangeTitle(e.target.value);\r\n  };\r\n\r\n  handleAskConvert = () => {\r\n    this.setState({\r\n      askChangeEditor: true,\r\n    });\r\n  };\r\n\r\n  handleConfirmConvert = () => {\r\n    this.setState({\r\n      askChangeEditor: false,\r\n    });\r\n    if (!this.codemirror) return;\r\n    const markdown = this.codemirror.getValue();\r\n    this.props.onConvert(markdown);\r\n  };\r\n\r\n  handleCancelConvert = () => {\r\n    this.setState({\r\n      askChangeEditor: false,\r\n    });\r\n  };\r\n\r\n  handleAppleTextareaChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n    this.props.onChangeMarkdown(e.target.value);\r\n    this.setState({\r\n      appleCursorPos: e.target.selectionStart,\r\n    });\r\n  };\r\n\r\n  public render() {\r\n    const { addLink, clientWidth } = this.state;\r\n    const { title, tagInput, footer } = this.props;\r\n    return (\r\n      <MarkdownEditorBlock ref={this.block} data-testid=\"codemirror\">\r\n        <div className=\"wrapper\">\r\n          <WriterHead hide={this.state.hideUpper}>\r\n            {ssrEnabled ? (\r\n              <TitleTextareaForSSR placeholder=\"제목을 입력하세요\" rows={1} />\r\n            ) : (\r\n              <TitleTextarea\r\n                placeholder=\"제목을 입력하세요\"\r\n                onChange={this.handleTitleChange}\r\n                value={title}\r\n              />\r\n            )}\r\n            <HorizontalBar />\r\n            {tagInput}\r\n          </WriterHead>\r\n          <Toolbar\r\n            shadow={this.state.hideUpper}\r\n            mode=\"MARKDOWN\"\r\n            onClick={this.handleToolbarClick}\r\n            onConvert={this.handleAskConvert}\r\n            innerRef={this.toolbarElement}\r\n            ios={this.isIOS}\r\n          />\r\n          <MarkdownWrapper>\r\n            {addLink.visible && (\r\n              <AddLink\r\n                defaultValue=\"\"\r\n                left={addLink.left}\r\n                top={addLink.top}\r\n                bottom={addLink.bottom}\r\n                stickToRight={addLink.stickToRight}\r\n                onConfirm={this.handleConfirmAddLink}\r\n                onClose={this.handleCancelAddLink}\r\n              />\r\n            )}\r\n            <textarea ref={this.editorElement} style={{ display: 'none' }} />\r\n            {this.isIOS && (\r\n              <AppleTextarea\r\n                onChange={this.handleAppleTextareaChange}\r\n                ref={this.appleEditorElement}\r\n                value={this.props.markdown}\r\n              />\r\n            )}\r\n          </MarkdownWrapper>\r\n        </div>\r\n        <AskChangeEditor\r\n          visible={this.state.askChangeEditor}\r\n          onConfirm={this.handleConfirmConvert}\r\n          onCancel={this.handleCancelConvert}\r\n          convertTo={WriteMode.WYSIWYG}\r\n        />\r\n        <FooterWrapper style={{ width: clientWidth || '50%' }}>\r\n          {footer}\r\n        </FooterWrapper>\r\n      </MarkdownEditorBlock>\r\n    );\r\n  }\r\n}\r\n\r\nconst MarkdownEditorBlock = styled.div`\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  position: relative;\r\n\r\n  &::-webkit-scrollbar {\r\n    border-radius: 3px;\r\n    width: 6px;\r\n    &:hover {\r\n      width: 16px;\r\n    }\r\n    background: ${palette.gray1};\r\n  }\r\n\r\n  &::-webkit-scrollbar-thumb {\r\n    z-index: 100;\r\n    background: ${palette.gray9};\r\n    /* -webkit-box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.75); */\r\n  }\r\n\r\n  & > .wrapper {\r\n    min-height: 0;\r\n    padding-bottom: 4rem;\r\n    flex: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n\r\n  .CodeMirror-lines {\r\n    padding: 4px 0; /* Vertical padding around content */\r\n    padding-bottom: 3rem;\r\n  }\r\n\r\n  .CodeMirror pre.CodeMirror-line,\r\n  .CodeMirror pre.CodeMirror-line-like {\r\n    padding: 0 3rem; /* Horizontal padding of content */\r\n    ${mediaQuery(767)} {\r\n      padding: 0 1rem;\r\n    }\r\n  }\r\n\r\n  .CodeMirror {\r\n    min-height: 0;\r\n    flex: 1;\r\n    font-size: 1.125rem;\r\n    line-height: 1.5;\r\n    color: ${palette.gray8};\r\n    font-family: 'Fira Mono', monospace;\r\n    /* font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New', */\r\n    .cm-header {\r\n      line-height: 1.5;\r\n      color: ${palette.gray9};\r\n    }\r\n    .cm-header-1 {\r\n      font-size: 2.5rem;\r\n    }\r\n    .cm-header-2 {\r\n      font-size: 2rem;\r\n    }\r\n    .cm-header-3 {\r\n      font-size: 1.5rem;\r\n    }\r\n    .cm-header-4,\r\n    .cm-header-5,\r\n    .cm-header-6 {\r\n      font-size: 1.3125rem;\r\n    }\r\n    .cm-strong,\r\n    .cm-em {\r\n      color: ${palette.gray9};\r\n    }\r\n    .CodeMirror-placeholder {\r\n      color: ${palette.gray5};\r\n      font-style: italic;\r\n    }\r\n\r\n    ${media.custom(767)} {\r\n      font-size: 0.875rem;\r\n      .cm-header-1 {\r\n        font-size: 2rem;\r\n      }\r\n      .cm-header-2 {\r\n        font-size: 1.5rem;\r\n      }\r\n      .cm-header-3 {\r\n        font-size: 1.15rem;\r\n      }\r\n      .cm-header-4,\r\n      .cm-header-5,\r\n      .cm-header-6 {\r\n        font-size: 1rem;\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nconst HorizontalBar = styled.div`\r\n  background: ${palette.gray7};\r\n  height: 6px;\r\n  width: 4rem;\r\n  margin-top: 1.5rem;\r\n  margin-bottom: 1rem;\r\n  ${mediaQuery(767)} {\r\n    margin-top: 1rem;\r\n    margin-bottom: 0.66rem;\r\n  }\r\n  border-radius: 1px;\r\n`;\r\n\r\nconst PaddingWrapper = styled.div`\r\n  padding-top: 2rem;\r\n  padding-left: 3rem;\r\n  padding-right: 3rem;\r\n  ${mediaQuery(767)} {\r\n    padding: 1rem;\r\n  }\r\n`;\r\n\r\nconst MarkdownWrapper = styled.div`\r\n  flex: 1;\r\n  min-height: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst FooterWrapper = styled.div`\r\n  position: fixed;\r\n  bottom: 0;\r\n  width: 100%;\r\n  z-index: ${zIndexes.WriteFooter};\r\n`;\r\n\r\nconst AppleTextarea = styled.textarea`\r\n  flex: 1;\r\n  outline: none;\r\n  font-size: 1.125rem;\r\n  padding-left: 3rem;\r\n  padding-right: 3rem;\r\n  line-height: 1.5;\r\n  padding-bottom: 3rem;\r\n  color: ${palette.gray8};\r\n  ${media.custom(767)} {\r\n    font-size: 0.875rem;\r\n    padding-left: 1rem;\r\n    padding-right: 1rem;\r\n    padding-bottom: 1rem;\r\n  }\r\n`;\r\n\r\nconst checker = {\r\n  youtube: (text: string) => {\r\n    const regex = /^<iframe.*src=\"https:\\/\\/www.youtube.com\\/embed\\/(.*?)\".*<\\/iframe>$/;\r\n    const result = regex.exec(text);\r\n    if (!result) return null;\r\n    return result[1];\r\n  },\r\n  twitter: (text: string) => {\r\n    if (!/^<blockquote class=\"twitter-tweet/.test(text)) return null;\r\n    const regex = /href=\"(.*?)\"/g;\r\n    const links = [];\r\n    let match = regex.exec(text);\r\n    while (match) {\r\n      links.push(match[1]);\r\n      match = regex.exec(text);\r\n    }\r\n    const pathMatch = /twitter.com\\/(.*?)\\?/.exec(links[links.length - 1]);\r\n    if (!pathMatch) return null;\r\n    return pathMatch[1];\r\n  },\r\n  codesandbox: (text: string) => {\r\n    const regex = /^<iframe.*src=\"https:\\/\\/codesandbox.io\\/embed\\/(.*?)\".*<\\/iframe>$/s;\r\n    const result = regex.exec(text);\r\n    if (!result) return null;\r\n    return result[1];\r\n  },\r\n  codepen: (text: string) => {\r\n    const regex = /^<iframe.*src=\"https:\\/\\/codepen.io\\/(.*?)\".*/;\r\n    const result = regex.exec(text);\r\n    console.log(result);\r\n    if (!result) return null;\r\n    return result[1];\r\n  },\r\n};\r\n","import * as React from 'react';\r\nimport styled from 'styled-components';\r\nimport palette from '../../lib/styles/palette';\r\nimport transitions from '../../lib/styles/transitions';\r\nimport { mediaQuery } from '../../lib/styles/media';\r\nimport { useTransition, animated } from 'react-spring';\r\n\r\nexport interface TagInputProps {\r\n  ref?: React.RefObject<HTMLDivElement>;\r\n  tags: string[];\r\n  onChange: (tags: string[]) => void;\r\n}\r\n\r\nconst TagItem: React.FC<{\r\n  onClick: (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\r\n}> = ({ onClick, children }) => {\r\n  return <Tag onClick={onClick}>{children}</Tag>;\r\n};\r\n\r\nconst { useState, useCallback, useEffect, useRef } = React;\r\nconst TagInput: React.FC<TagInputProps> = ({ onChange, tags: initialTags }) => {\r\n  const [tags, setTags] = useState<string[]>(initialTags);\r\n  const [value, setValue] = useState('');\r\n  const [focus, setFocus] = useState(false);\r\n  const ignore = useRef(false);\r\n  const editableDiv = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (tags.length === 0) return;\r\n    onChange(tags);\r\n  }, [tags, onChange]);\r\n\r\n  useEffect(() => {\r\n    setTags(initialTags);\r\n  }, [initialTags]);\r\n\r\n  const onChangeInput = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setValue(e.target.value);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (editableDiv.current) {\r\n      if (value === '') {\r\n        editableDiv.current.innerText = value;\r\n      }\r\n    }\r\n  }, [value]);\r\n\r\n  const insertTag = useCallback(\r\n    (tag: string) => {\r\n      ignore.current = true;\r\n      setValue('');\r\n      if (tag === '' || tags.includes(tag)) return;\r\n      let processed = tag;\r\n      processed = tag.trim();\r\n      if (processed.indexOf(' #') > 0) {\r\n        const tempTags: string[] = [];\r\n        const regex = /#(\\S+)/g;\r\n        let execArray: RegExpExecArray | null = null;\r\n        while ((execArray = regex.exec(processed))) {\r\n          if (execArray !== null) {\r\n            tempTags.push(execArray[1]);\r\n          }\r\n        }\r\n        setTags([...tags, ...tempTags]);\r\n        return;\r\n      }\r\n      if (processed.charAt(0) === '#') {\r\n        processed = processed.slice(1, processed.length);\r\n      }\r\n      setTags([...tags, processed]);\r\n    },\r\n    [tags],\r\n  );\r\n\r\n  const onKeyDown = useCallback(\r\n    (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n      if (e.key === 'Backspace' && value === '') {\r\n        setTags(tags.slice(0, tags.length - 1));\r\n        return;\r\n      }\r\n      const keys = [',', 'Enter'];\r\n      if (keys.includes(e.key)) {\r\n        // 등록\r\n        e.preventDefault();\r\n        insertTag(value);\r\n      }\r\n    },\r\n    [insertTag, tags, value],\r\n  );\r\n\r\n  const onRemove = (tag: string) => {\r\n    const nextTags = tags.filter(t => t !== tag);\r\n    setTags(nextTags);\r\n  };\r\n\r\n  return (\r\n    <TagInputBlock>\r\n      {tags.map(tag => (\r\n        <TagItem key={tag} onClick={() => onRemove(tag)}>\r\n          {tag}\r\n        </TagItem>\r\n      ))}\r\n      <StyledInput\r\n        placeholder=\"태그를 입력하세요\"\r\n        tabIndex={2}\r\n        onKeyDown={onKeyDown}\r\n        onChange={onChangeInput}\r\n        value={value}\r\n        onFocus={() => setFocus(true)}\r\n        onBlur={() => setFocus(false)}\r\n      />\r\n      <Help focus={focus} />\r\n    </TagInputBlock>\r\n  );\r\n};\r\n\r\nfunction Help({ focus }: { focus: boolean }) {\r\n  const transitions = useTransition(focus, null, {\r\n    from: { opacity: 0, transform: 'translateY(-1rem)' },\r\n    enter: { opacity: 1, transform: 'translateY(0rem)' },\r\n    leave: { opacity: 0, transform: 'translateY(-1rem)' },\r\n    config: {\r\n      tension: 350,\r\n      friction: 22,\r\n    },\r\n  });\r\n\r\n  return (\r\n    <HelpBlock>\r\n      {transitions.map(({ item, key, props }) =>\r\n        item ? (\r\n          <animated.div className=\"inside\" style={props} key={key}>\r\n            쉼표 혹은 엔터를 입력하여 태그를 등록 할 수 있습니다.\r\n            <br />\r\n            등록된 태그를 클릭하면 삭제됩니다.\r\n          </animated.div>\r\n        ) : null,\r\n      )}\r\n    </HelpBlock>\r\n  );\r\n}\r\n\r\nconst HelpBlock = styled.div`\r\n  display: block;\r\n  width: 100%;\r\n\r\n  color: ${palette.gray7};\r\n  transition: ease-in 0.125s;\r\n\r\n  & > .inside {\r\n    position: absolute;\r\n    background: ${palette.gray8};\r\n    color: white;\r\n    padding: 0.75rem;\r\n    z-index: 20;\r\n    line-height: 1.5;\r\n    font-size: 0.75rem;\r\n  }\r\n`;\r\n\r\nconst TagInputBlock = styled.div`\r\n  color: ${palette.gray8};\r\n  font-size: 1.125rem;\r\n\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  [contenteditable='true']:empty:before {\r\n    content: attr(placeholder);\r\n    display: block; /* For Firefox */\r\n    color: ${palette.gray5};\r\n  }\r\n`;\r\nconst StyledInput = styled.input`\r\n  display: inline-flex;\r\n  outline: none;\r\n  cursor: text;\r\n  font-size: 1.125rem;\r\n  line-height: 2rem;\r\n  ${mediaQuery(767)} {\r\n    line-height: 1.5rem;\r\n    font-size: 0.75rem;\r\n  }\r\n  margin-bottom: 0.75rem;\r\n  min-width: 8rem;\r\n  border: none;\r\n`;\r\n\r\nconst Tag = styled.div`\r\n  color: ${palette.gray9};\r\n  font-size: 1rem;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  height: 2rem;\r\n  border-radius: 1rem;\r\n  padding-left: 1rem;\r\n  padding-right: 1rem;\r\n  background: ${palette.gray1};\r\n  color: ${palette.teal7};\r\n  margin-right: 0.75rem;\r\n  transition: ease-in 0.125s;\r\n  cursor: pointer;\r\n  &:hover {\r\n    opacity: 0.6;\r\n  }\r\n  margin-bottom: 0.75rem;\r\n  animation: ${transitions.popIn} 0.125s forwards ease-in-out;\r\n  ${mediaQuery(767)} {\r\n    height: 1.5rem;\r\n    font-size: 0.75rem;\r\n    border-radius: 0.75rem;\r\n    padding-left: 0.75rem;\r\n    padding-right: 0.75rem;\r\n    margin-right: 0.5rem;\r\n    margin-bottom: 0.5rem;\r\n  }\r\n`;\r\n\r\nexport default TagInput;\r\n","import * as React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { RootState } from '../../modules';\r\nimport TagInput from '../../components/write/TagInput';\r\nimport { changeTags } from '../../modules/write';\r\n\r\ninterface OwnProps {}\r\ntype StateProps = ReturnType<typeof mapStateToProps>;\r\ntype DispatchProps = typeof mapDispatchToProps;\r\nexport type TagInputContainerProps = OwnProps & StateProps & DispatchProps;\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  tags: state.write.tags,\r\n});\r\nconst mapDispatchToProps = {\r\n  changeTags,\r\n};\r\n\r\nconst TagInputContainer: React.FC<TagInputContainerProps> = ({\r\n  tags,\r\n  changeTags,\r\n}) => {\r\n  return <TagInput tags={tags} onChange={changeTags} />;\r\n};\r\n\r\nexport default connect<StateProps, DispatchProps, OwnProps, RootState>(\r\n  mapStateToProps,\r\n  mapDispatchToProps,\r\n)(TagInputContainer);\r\n","import * as React from 'react';\r\nimport styled from 'styled-components';\r\nimport Button from '../common/Button';\r\n// import { MdArrowBack } from 'react-icons/md';\r\n// import media from '../../lib/styles/media';\r\n\r\n\r\nconst WriteFooterBlock = styled.div`\r\n  height: 4rem;\r\n  width: 100%;\r\n  box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);\r\n  background: rgba(255, 255, 255, 0.85);\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  align-items: center;\r\n`;\r\n\r\nconst Group = styled.div`\r\n  justify-content: flex-end;\r\n  align-items: center;\r\n`;\r\n\r\nconst StyledButton = styled(Button)`\r\n  height: 2.5rem;\r\n  font-size: 1.125rem;\r\n  & + & {\r\n    margin-right: 0.75rem;\r\n  }\r\n`;\r\n\r\n// const BackButton = styled.button`\r\n//   height: 2.5rem;\r\n//   padding: 0.5rem 1rem;\r\n//   align-items: center;\r\n//   background: none;\r\n//   border-radius: 4px;\r\n//   cursor: pointer;\r\n//   border: none;\r\n//   display: flex;\r\n//   outline: none;\r\n//   &:hover,\r\n//   &:focus {\r\n//     background: rgba(0, 0, 0, 0.05);\r\n//   }\r\n//   svg {\r\n//     font-size: 1.25rem;\r\n//     margin-right: 0.5rem;\r\n//   }\r\n//   span {\r\n//     font-size: 1.125rem;\r\n//     ${media.xsmall} {\r\n//       display: none;\r\n//     }\r\n//   }\r\n// `;\r\n\r\nexport interface WriteFooterProps {\r\n  // onTempSave: (notify?: boolean) => void;\r\n  onSave: () => void; // onPublish\r\n  onGoBack: () => void;\r\n  edit: boolean;\r\n}\r\n\r\nconst WriteFooter: React.FC<WriteFooterProps> = ({\r\n  onGoBack,\r\n  // onTempSave,\r\n  onSave,\r\n  edit,\r\n}) => {\r\n  return (\r\n    <WriteFooterBlock>\r\n      <Group>\r\n      <StyledButton inline color=\"lightGray\" /*onClick={() => onTempSave(true)}*/>\r\n          임시저장\r\n        </StyledButton>\r\n        <StyledButton inline color=\"teal\" onClick={onSave}>\r\n          저장하기\r\n        </StyledButton>\r\n      </Group>\r\n    </WriteFooterBlock>\r\n  );\r\n};\r\n\r\nexport default WriteFooter;\r\n","import visit from 'unist-util-visit';\r\n\r\n// const regex = /!(youtube|twitter|codesandbox)\\[(.*?)\\]/;\r\n\r\nconst embedTypeRegex = /^!(youtube|twitter|codesandbox|codepen)$/;\r\nconst converters = {\r\n  youtube: (code: string) =>\r\n    `<iframe class=\"embed\" src=\"https://www.youtube.com/embed/${code}\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>`,\r\n  twitter: (code: string) =>\r\n    `<blockquote class=\"twitter-wrapper\"><blockquote class=\"twitter-tweet\" data-lang=\"ko\"><a href=\"https://twitter.com/${code}\"></a></blockquote></blockquote>`,\r\n  codesandbox: (code: string) =>\r\n    `<iframe class=\"embed\" src=\"https://codesandbox.io/embed/${code}\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>`,\r\n  codepen: (code: string) =>\r\n    `<iframe class=\"embed\" scrolling=\"no\" title=\"Tab Menu Layout2\" src=\"https://codepen.io/${code}\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\"></iframe>`,\r\n};\r\n\r\ntype ConverterKey = keyof typeof converters;\r\n\r\nexport default function embedPlugin() {\r\n  function transformer(tree: any, file: any) {\r\n    function visitor(node: any) {\r\n      try {\r\n        const { children }: { children: any[] } = node;\r\n        if (children.length < 2) return;\r\n        const index = children.findIndex(childNode => {\r\n          if (!childNode.value) return false;\r\n          return childNode.value.match(embedTypeRegex);\r\n        });\r\n        if (index === -1) return;\r\n        const childNode = children[index];\r\n        const siblingNode = children[index + 1];\r\n        if (!siblingNode || siblingNode.type !== 'linkReference') return;\r\n        const { label } = siblingNode;\r\n        const match = embedTypeRegex.exec(children[index].value);\r\n        if (!match) return;\r\n        const type = match[1] as ConverterKey;\r\n\r\n        childNode.type = 'html';\r\n        childNode.value = converters[type](label);\r\n        children.splice(index + 1, 1);\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n    }\r\n\r\n    visit(tree, 'paragraph', visitor);\r\n  }\r\n\r\n  return transformer;\r\n}\r\n","import React, { useMemo, useState } from 'react';\r\nimport MarkdownEditor from '../../components/write/WriteMarkdownEditor';\r\nimport { useSelector, useDispatch, /*shallowEqual*/ } from 'react-redux';\r\nimport { RootState } from '../../modules';\r\nimport {\r\n  changeMarkdown,\r\n  changeTitle,\r\n  setHtml,\r\n  convertEditorMode,\r\n  openPublish,\r\n  setDefaultDescription,\r\n  setThumbnail,\r\n  // setWritePostId,\r\n  setInitialBody,\r\n} from '../../modules/write';\r\n\r\nimport remark from 'remark';\r\nimport htmlPlugin from 'remark-html';\r\nimport breaks from 'remark-breaks';\r\n// import strip from 'strip-markdown';\r\nimport TagInputContainer from './TagInputContainer';\r\nimport WriteFooter from '../../components/write/WriteFooter';\r\n// import useUpload from '../../lib/hooks/useUpload';\r\n// import useS3Upload from '../../lib/hooks/useS3Upload';\r\n// import DragDropUpload from '../../components/common/DragDropUpload';\r\n// import PasteUpload from '../../components/common/PasteUpload';\r\nimport { bindActionCreators } from 'redux';\r\n// import { useMutation } from '@apollo/react-hooks';\r\n// import {\r\n//   WritePostResponse,\r\n//   WRITE_POST,\r\n//   CreatePostHistoryResponse,\r\n//   CREATE_POST_HISTORY,\r\n//   EditPostResult,\r\n//   EDIT_POST,\r\n// } from '../../lib/graphql/post';\r\n// import { escapeForUrl } from '../../lib/utils';\r\n// import { useHistory } from 'react-router';\r\n// import useSaveHotKey from './hooks/useSaveHotkey';\r\nimport embedPlugin from '../../lib/remark/embedPlugin';\r\nimport { Helmet } from 'react-helmet-async';\r\n// import { toast } from 'react-toastify';\r\nimport useDownload from '../../lib/hooks/useDownload';\r\n// import { usePrevious } from 'react-use';\r\n\r\nexport type MarkdownEditorContainerProps = {};\r\n\r\nconst { useCallback, useEffect } = React;\r\n\r\nconst MarkdownEditorContainer: React.FC<MarkdownEditorContainerProps> = () => {\r\n  // const history = useHistory();\r\n  const {\r\n    title,\r\n    markdown,\r\n    // thumbnail,\r\n    postId,\r\n    isTemp,\r\n    initialBody,\r\n    initialTitle,\r\n    tags,\r\n  } = useSelector((state: RootState) => state.write);\r\n  // const [writePost] = useMutation<WritePostResponse>(WRITE_POST);\r\n  // const [createPostHistory] = useMutation<CreatePostHistoryResponse>(\r\n  //   CREATE_POST_HISTORY,\r\n  // );\r\n  // const [editPost] = useMutation<EditPostResult>(EDIT_POST);\r\n\r\n  const [/*lastSavedData*/, setLastSavedData] = useState({\r\n    title: initialTitle,\r\n    body: initialBody,\r\n  });\r\n\r\n  const onGoBack = () => {\r\n    // history.goBack();\r\n  };\r\n\r\n  useEffect(() => {\r\n    setLastSavedData({\r\n      title: initialTitle,\r\n      body: initialBody,\r\n    });\r\n  }, [initialTitle, initialBody]);\r\n\r\n  const dispatch = useDispatch();\r\n  const actionCreators = useMemo(\r\n    () =>\r\n      bindActionCreators(\r\n        {\r\n          changeMarkdown,\r\n          changeTitle,\r\n          setHtml,\r\n          convertEditorMode,\r\n          openPublish,\r\n          setDefaultDescription,\r\n          setThumbnail,\r\n          setInitialBody,\r\n        },\r\n        dispatch,\r\n      ),\r\n    [dispatch],\r\n  );\r\n\r\n  const onConvert = (markdown: string) => {\r\n    remark()\r\n      .use(breaks)\r\n      .use(htmlPlugin)\r\n      .use(embedPlugin)\r\n      .process(markdown, (err: any, file: any) => {\r\n        const html = String(file);\r\n        console.log(html);\r\n        actionCreators.setHtml(html);\r\n        actionCreators.setInitialBody(html);\r\n        actionCreators.convertEditorMode();\r\n      });\r\n  };\r\n\r\n  const onDownload = useDownload();\r\n\r\n  const onSave = useCallback(() => {\r\n    // (/#(.*?)\\n/g, '').replace(/\\n/g, '')\r\n    const header = \r\n`---\r\ntitle: ${title}\r\ntags: [${tags.join(', ')}]\r\n---`;\r\n    onDownload(title, header + markdown);\r\n\r\n    // remark()\r\n    //   .use(strip)\r\n    //   .process(markdown.replace(/#(.*?)\\n/g, ''), (err: any, file: any) => {\r\n    //     const text = String(file);\r\n    //     const sliced = text.replace(/\\n/g, '').slice(0, 150);\r\n    //     actionCreators.setDefaultDescription(sliced);\r\n    //     actionCreators.openPublish();\r\n    //   });\r\n  }, [/*actionCreators,*/ title, markdown, tags, onDownload]);\r\n\r\n  // const [upload, file] = useUpload();\r\n  // const [s3Upload, image] = useS3Upload();\r\n  // const prevImage = usePrevious(image);\r\n\r\n  // useEffect(() => {\r\n  //   if (!file) return;\r\n  //   s3Upload(file, {\r\n  //     type: 'post',\r\n  //   });\r\n  // }, [file, s3Upload]);\r\n\r\n  // useEffect(() => {\r\n  //   if (image !== prevImage && !thumbnail && image) {\r\n  //     actionCreators.setThumbnail(image);\r\n  //   }\r\n  // }, [actionCreators, image, prevImage, thumbnail]);\r\n\r\n  // const onDragDropUpload = useCallback(\r\n  //   (file: File) => {\r\n  //     s3Upload(file, {\r\n  //       type: 'post',\r\n  //     });\r\n  //   },\r\n  //   [s3Upload],\r\n  // );\r\n\r\n  // const onTempSave = useCallback(\r\n  //   async (notify?: boolean) => {\r\n  //     if (!title || !markdown) {\r\n  //       toast.error('제목 또는 내용이 비어있습니다.');\r\n  //       return;\r\n  //     }\r\n\r\n  //     const notifySuccess = () => {\r\n  //       if (!notify) return;\r\n  //       toast.success('포스트가 임시저장되었습니다.');\r\n  //     };\r\n\r\n  //     if (!postId) {\r\n  //       const response = await writePost({\r\n  //         variables: {\r\n  //           title,\r\n  //           body: markdown,\r\n  //           tags,\r\n  //           is_markdown: true,\r\n  //           is_temp: true,\r\n  //           is_private: false,\r\n  //           url_slug: escapeForUrl(title),\r\n  //           thumbnail: null,\r\n  //           meta: {},\r\n  //           series_id: null,\r\n  //         },\r\n  //       });\r\n  //       if (!response || !response.data) return;\r\n  //       const { id } = response.data.writePost;\r\n  //       dispatch(setWritePostId(id));\r\n  //       history.replace(`/write?id=${id}`);\r\n  //       notifySuccess();\r\n  //       return;\r\n  //     }\r\n  //     // tempsaving unreleased post:\r\n  //     if (isTemp) {\r\n  //       await editPost({\r\n  //         variables: {\r\n  //           id: postId,\r\n  //           title,\r\n  //           body: markdown,\r\n  //           is_markdown: true,\r\n  //           is_temp: true,\r\n  //           is_private: false,\r\n  //           url_slug: escapeForUrl(title),\r\n  //           thumbnail: null,\r\n  //           meta: {},\r\n  //           series_id: null,\r\n  //           tags,\r\n  //         },\r\n  //       });\r\n  //       notifySuccess();\r\n  //       return;\r\n  //     }\r\n\r\n  //     // tempsaving released post:\r\n  //     // save only if something has been changed\r\n  //     if (shallowEqual(lastSavedData, { title, body: markdown })) {\r\n  //       return;\r\n  //     }\r\n  //     // await createPostHistory({\r\n  //     //   variables: {\r\n  //     //     post_id: postId,\r\n  //     //     title,\r\n  //     //     body: markdown,\r\n  //     //     is_markdown: true,\r\n  //     //   },\r\n  //     // });\r\n  //     // setLastSavedData({\r\n  //     //   title,\r\n  //     //   body: markdown,\r\n  //     // });\r\n  //     // notifySuccess();\r\n  //   },\r\n  //   [\r\n  //     createPostHistory,\r\n  //     dispatch,\r\n  //     editPost,\r\n  //     history,\r\n  //     isTemp,\r\n  //     lastSavedData,\r\n  //     markdown,\r\n  //     postId,\r\n  //     tags,\r\n  //     title,\r\n  //     writePost,\r\n  //   ],\r\n  // );\r\n\r\n  // useEffect(() => {\r\n  //   const changed = !shallowEqual(lastSavedData, { title, body: markdown });\r\n  //   if (changed) {\r\n  //     const timeoutId = setTimeout(() => {\r\n  //       if (!postId && !title && markdown.length < 30) return;\r\n  //       onTempSave(true);\r\n  //     }, 10 * 1000);\r\n\r\n  //     return () => {\r\n  //       clearTimeout(timeoutId);\r\n  //     };\r\n  //   }\r\n  // }, [title, postId, onTempSave, lastSavedData, markdown]);\r\n\r\n  // useSaveHotKey(() => onTempSave(true));\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{title ? `(작성중) ${title}` : '새 글 작성'}</title>\r\n      </Helmet>\r\n      <MarkdownEditor\r\n        // onUpload={upload}\r\n        // lastUploadedImage={image}\r\n        initialBody={initialBody}\r\n        title={title}\r\n        markdown={markdown}\r\n        onChangeMarkdown={actionCreators.changeMarkdown}\r\n        onChangeTitle={actionCreators.changeTitle}\r\n        onConvert={onConvert}\r\n        tagInput={<TagInputContainer />}\r\n        footer={\r\n          <WriteFooter\r\n            onSave={onSave}\r\n            // onTempSave={onTempSave}\r\n            onGoBack={onGoBack}\r\n            edit={!!postId && !isTemp}\r\n          />\r\n        }\r\n      />\r\n      {/* <DragDropUpload onUpload={onDragDropUpload} /> */}\r\n      {/* <PasteUpload onUpload={onDragDropUpload} /> */}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MarkdownEditorContainer;\r\n","import { useCallback } from \"react\";\r\n\r\nexport default function useDownload() {\r\n  const onDownload = useCallback((title: string, markdown: string) => {\r\n    const element = document.createElement('a');\r\n    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(markdown));\r\n    element.setAttribute('download', `${title.trim().replace(' ', '-')}.md`);\r\n  \r\n    element.style.display = 'none';\r\n    document.body.appendChild(element);\r\n  \r\n    element.click();\r\n  \r\n    document.body.removeChild(element);\r\n  }, []);\r\n\r\n  return onDownload;\r\n};\r\n","/* eslint-disable */\r\nimport visit from 'unist-util-visit';\r\nimport Prism from 'prismjs';\r\n\r\nimport 'prismjs/components/prism-bash.min';\r\nimport 'prismjs/components/prism-typescript.min';\r\nimport 'prismjs/components/prism-javascript.min';\r\nimport 'prismjs/components/prism-markup-templating.min';\r\nimport 'prismjs/components/prism-jsx.min';\r\nimport 'prismjs/components/prism-css.min';\r\nimport 'prismjs/components/prism-python.min';\r\nimport 'prismjs/components/prism-go.min';\r\nimport 'prismjs/components/prism-scss.min';\r\nimport 'prismjs/components/prism-java.min';\r\nimport 'prismjs/components/prism-c.min';\r\nimport 'prismjs/components/prism-cpp.min';\r\nimport 'prismjs/components/prism-csharp.min';\r\nimport 'prismjs/components/prism-graphql.min';\r\nimport 'prismjs/components/prism-tsx.min';\r\nimport 'prismjs/components/prism-php.min';\r\nimport 'prismjs/components/prism-aspnet.min';\r\nimport 'prismjs/components/prism-sql.min';\r\nimport 'prismjs/components/prism-swift.min';\r\nimport 'prismjs/components/prism-kotlin.min';\r\nimport 'prismjs/components/prism-erlang.min';\r\nimport 'prismjs/components/prism-elixir.min';\r\nimport 'prismjs/components/prism-ruby.min';\r\nimport 'prismjs/components/prism-rust.min';\r\nimport 'prismjs/components/prism-yaml.min';\r\nimport 'prismjs/components/prism-dart';\r\n\r\nimport { ssrEnabled } from '../utils';\r\n\r\nexport default function attacher({ include, exclude } = {}) {\r\n  function visitor(node) {\r\n    let { lang, data } = node;\r\n\r\n    // if (\r\n    //   !lang ||\r\n    //   (include && include.indexOf(lang) === -1) ||\r\n    //   (exclude && exclude.indexOf(lang) !== -1)\r\n    // ) {\r\n    //   return;\r\n    // }\r\n\r\n    if (!data) {\r\n      data = {};\r\n      node.data = data;\r\n    }\r\n\r\n    if (!data.hProperties) {\r\n      data.hProperties = {};\r\n    }\r\n\r\n    if (!ssrEnabled) {\r\n      window.prism = Prism;\r\n    }\r\n\r\n    const highlighted = Prism.highlight(\r\n      node.value,\r\n      Prism.languages[lang] || Prism.languages.markup,\r\n    );\r\n\r\n    node.type = 'html';\r\n    node.value = `<pre><code class=\"language-${lang}\">${highlighted}</code></pre>`;\r\n    // console.log(data);\r\n    // data.hChildren = '<div>so what?</div>';\r\n    // data.hChildren =\r\n    // data.hChildren = low.highlight(lang, node.value).value;\r\n    // data.hProperties.className = [\r\n    //   'hljs',\r\n    //   ...(data.hProperties.className || []),\r\n    //   'language-' + lang,\r\n    // ];\r\n  }\r\n  return ast => visit(ast, 'code', visitor);\r\n}\r\n","import { css } from 'styled-components';\r\n\r\nconst prismThemes = {\r\n  'atom-one-dark': css`\r\n    pre {\r\n      background: #313440;\r\n    }\r\n    /**\r\n * prism.js default theme for JavaScript, CSS and HTML\r\n * Based on dabblet (http://dabblet.com)\r\n * @author Lea Verou\r\n */\r\n    code[class*='language-'],\r\n    pre[class*='language-'] {\r\n      color: #e0e6f1;\r\n      background: none;\r\n      text-align: left;\r\n      white-space: pre;\r\n      word-spacing: normal;\r\n      word-break: normal;\r\n      word-wrap: normal;\r\n\r\n      -moz-tab-size: 4;\r\n      -o-tab-size: 4;\r\n      tab-size: 4;\r\n      -webkit-hyphens: none;\r\n      -moz-hyphens: none;\r\n      -ms-hyphens: none;\r\n      hyphens: none;\r\n    }\r\n\r\n    pre[class*='language-']::-moz-selection,\r\n    pre[class*='language-'] ::-moz-selection,\r\n    code[class*='language-']::-moz-selection,\r\n    code[class*='language-'] ::-moz-selection {\r\n      text-shadow: none;\r\n      background: #383e49;\r\n    }\r\n\r\n    pre[class*='language-']::selection,\r\n    pre[class*='language-'] ::selection,\r\n    code[class*='language-']::selection,\r\n    code[class*='language-'] ::selection {\r\n      text-shadow: none;\r\n      background: #9aa2b1;\r\n    }\r\n\r\n    @media print {\r\n      code[class*='language-'],\r\n      pre[class*='language-'] {\r\n        text-shadow: none;\r\n      }\r\n    }\r\n    /* Code blocks */\r\n    pre[class*='language-'] {\r\n      padding: 1em;\r\n      margin: 0.5em 0;\r\n      overflow: auto;\r\n    }\r\n\r\n    :not(pre) > code[class*='language-'],\r\n    pre[class*='language-'] {\r\n      background: #282c34;\r\n    }\r\n\r\n    /* Inline code */\r\n    :not(pre) > code[class*='language-'] {\r\n      padding: 0.1em;\r\n      border-radius: 0.3em;\r\n      white-space: normal;\r\n    }\r\n\r\n    .token.comment,\r\n    .token.prolog,\r\n    .token.doctype,\r\n    .token.cdata {\r\n      color: #5c6370;\r\n    }\r\n\r\n    .token.punctuation {\r\n      color: #abb2bf;\r\n    }\r\n\r\n    .token.selector,\r\n    .token.tag {\r\n      color: #e06c75;\r\n    }\r\n\r\n    .token.property,\r\n    .token.boolean,\r\n    .token.number,\r\n    .token.constant,\r\n    .token.symbol,\r\n    .token.attr-name,\r\n    .token.deleted {\r\n      color: #d19a66;\r\n    }\r\n\r\n    .token.string,\r\n    .token.char,\r\n    .token.attr-value,\r\n    .token.builtin,\r\n    .token.inserted {\r\n      color: #98c379;\r\n    }\r\n\r\n    .token.operator,\r\n    .token.entity,\r\n    .token.url,\r\n    .language-css .token.string,\r\n    .style .token.string {\r\n      color: #56b6c2;\r\n    }\r\n\r\n    .token.atrule,\r\n    .token.keyword {\r\n      color: #c678dd;\r\n    }\r\n\r\n    .token.function {\r\n      color: #61afef;\r\n    }\r\n\r\n    .token.regex,\r\n    .token.important,\r\n    .token.variable {\r\n      color: #c678dd;\r\n    }\r\n\r\n    .token.important,\r\n    .token.bold {\r\n      font-weight: bold;\r\n    }\r\n\r\n    .token.italic {\r\n      font-style: italic;\r\n    }\r\n\r\n    .token.entity {\r\n      cursor: help;\r\n    }\r\n\r\n    pre.line-numbers {\r\n      position: relative;\r\n      padding-left: 3.8em;\r\n      counter-reset: linenumber;\r\n    }\r\n\r\n    pre.line-numbers > code {\r\n      position: relative;\r\n    }\r\n\r\n    .line-numbers .line-numbers-rows {\r\n      position: absolute;\r\n      pointer-events: none;\r\n      top: 0;\r\n      font-size: 100%;\r\n      left: -3.8em;\r\n      width: 3em; /* works for line-numbers below 1000 lines */\r\n      letter-spacing: -1px;\r\n      border-right: 0;\r\n\r\n      -webkit-user-select: none;\r\n      -moz-user-select: none;\r\n      -ms-user-select: none;\r\n      user-select: none;\r\n    }\r\n\r\n    .line-numbers-rows > span {\r\n      pointer-events: none;\r\n      display: block;\r\n      counter-increment: linenumber;\r\n    }\r\n\r\n    .line-numbers-rows > span:before {\r\n      content: counter(linenumber);\r\n      color: #5c6370;\r\n      display: block;\r\n      padding-right: 0.8em;\r\n      text-align: right;\r\n    }\r\n  `,\r\n  'atom-one-light': css`\r\n    code,\r\n    code[class*='language-'],\r\n    pre[class*='language-'] {\r\n      color: #24292e;\r\n    }\r\n    pre {\r\n      box-shadow: 0px 0px 2px #00000005;\r\n      background: #fbfcfd;\r\n      color: #24292e;\r\n      /* background: white; */\r\n    }\r\n    .token.builtin {\r\n      color: #0184bc;\r\n    }\r\n    .token.function {\r\n      color: #005cc5;\r\n    }\r\n    .token.comment,\r\n    .token.prolog,\r\n    .token.doctype,\r\n    .token.cdata {\r\n      color: #969896;\r\n    }\r\n    .token.punctuation {\r\n      color: #24292e;\r\n    }\r\n    .token.atrule,\r\n    .token.attr-value {\r\n      color: #183691;\r\n    }\r\n    .token.property,\r\n    .token.tag {\r\n      color: #63a35c;\r\n    }\r\n    .token.boolean,\r\n    .token.number {\r\n      color: #986801;\r\n    }\r\n    .token.selector,\r\n    .token.attr-name,\r\n    .token.attr-value .punctuation:first-child,\r\n    .token.keyword,\r\n    .token.regex,\r\n    .token.important {\r\n      color: #a626a4;\r\n    }\r\n    .token.operator {\r\n      color: #0184bc;\r\n    }\r\n    .token.entity,\r\n    .token.url,\r\n    .language-css,\r\n    .token.string {\r\n      color: #50a14f;\r\n    }\r\n    .token.entity {\r\n      cursor: help;\r\n    }\r\n    .namespace {\r\n      opacity: 0.7;\r\n    }\r\n  `,\r\n  github: css`\r\n    /**\r\n   * Github-like theme for Prism.js\r\n   * @author Luke Askew http://github.com/lukeaskew\r\n   */\r\n    code,\r\n    code[class*='language-'],\r\n    pre[class*='language-'] {\r\n      color: #24292e;\r\n    }\r\n    pre {\r\n      color: #24292e;\r\n      background: #f6f8fa;\r\n    }\r\n    .token.function {\r\n      color: #005cc5;\r\n    }\r\n    .token.comment,\r\n    .token.prolog,\r\n    .token.doctype,\r\n    .token.cdata {\r\n      color: #969896;\r\n    }\r\n    .token.punctuation {\r\n      color: #24292e;\r\n    }\r\n    .token.string {\r\n      color: #032f62;\r\n    }\r\n    .token.atrule,\r\n    .token.attr-value {\r\n      color: #183691;\r\n    }\r\n    .token.property,\r\n    .token.tag {\r\n      color: #63a35c;\r\n    }\r\n    .token.boolean,\r\n    .token.number {\r\n      color: #0086b3;\r\n    }\r\n    .token.selector,\r\n    .token.attr-name,\r\n    .token.attr-value .punctuation:first-child,\r\n    .token.keyword,\r\n    .token.regex,\r\n    .token.important {\r\n      color: #d73a49;\r\n    }\r\n    .token.operator,\r\n    .token.entity,\r\n    .token.url,\r\n    .language-css {\r\n      color: #d73a49;\r\n    }\r\n    .token.entity {\r\n      cursor: help;\r\n    }\r\n    .namespace {\r\n      opacity: 0.7;\r\n    }\r\n  `,\r\n  monokai: css`\r\n    /**\r\n * Monokai theme for Prism.JS\r\n *\r\n * @author Martijn Swaagman\r\n * @license MIT 2015\r\n */\r\n\r\n    code[class*='language-'],\r\n    pre[class*='language-'] {\r\n      color: #f8f8f2;\r\n      text-shadow: 0 1px rgba(0, 0, 0, 0.3);\r\n    }\r\n\r\n    :not(pre) > code[class*='language-'],\r\n    pre[class*='language-'] {\r\n      background: #272822;\r\n    }\r\n\r\n    pre {\r\n      color: #f8f8f2;\r\n      text-shadow: 0 1px rgba(0, 0, 0, 0.3);\r\n      background: #272822;\r\n    }\r\n\r\n    .token.comment,\r\n    .token.prolog,\r\n    .token.doctype,\r\n    .token.cdata {\r\n      color: #778090;\r\n    }\r\n\r\n    .token.punctuation {\r\n      color: #f8f8f2;\r\n    }\r\n\r\n    .namespace {\r\n      opacity: 0.7;\r\n    }\r\n\r\n    .token.property,\r\n    .token.tag,\r\n    .token.constant,\r\n    .token.symbol,\r\n    .token.deleted {\r\n      color: #f92672;\r\n    }\r\n\r\n    .token.boolean,\r\n    .token.number {\r\n      color: #ae81ff;\r\n    }\r\n\r\n    .token.selector,\r\n    .token.attr-name,\r\n    .token.string,\r\n    .token.char,\r\n    .token.builtin,\r\n    .token.inserted {\r\n      color: #a6e22e;\r\n    }\r\n\r\n    .token.operator,\r\n    .token.entity,\r\n    .token.url,\r\n    .language-css .token.string,\r\n    .style .token.string,\r\n    .token.variable {\r\n      color: #f8f8f2;\r\n    }\r\n\r\n    .token.atrule,\r\n    .token.attr-value,\r\n    .token.function {\r\n      color: #e6db74;\r\n    }\r\n\r\n    .token.keyword {\r\n      color: #f92672;\r\n    }\r\n\r\n    .token.regex,\r\n    .token.important {\r\n      color: #fd971f;\r\n    }\r\n\r\n    .token.important,\r\n    .token.bold {\r\n      font-weight: bold;\r\n    }\r\n\r\n    .token.italic {\r\n      font-style: italic;\r\n    }\r\n\r\n    .token.entity {\r\n      cursor: help;\r\n    }\r\n  `,\r\n  dracula: css`\r\n    /* PrismJS 1.14.0\r\nhttp://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript+abap+actionscript+ada+apacheconf+apl+applescript+c+arff+asciidoc+asm6502+aspnet+autohotkey+autoit+bash+basic+batch+bison+brainfuck+bro+cpp+csharp+arduino+coffeescript+clojure+ruby+csp+css-extras+d+dart+diff+django+docker+eiffel+elixir+elm+markup-templating+erlang+fsharp+flow+fortran+gedcom+gherkin+git+glsl+go+graphql+groovy+haml+handlebars+haskell+haxe+http+hpkp+hsts+ichigojam+icon+inform7+ini+io+j+java+jolie+json+julia+keyman+kotlin+latex+less+liquid+lisp+livescript+lolcode+lua+makefile+markdown+erb+matlab+mel+mizar+monkey+n4js+nasm+nginx+nim+nix+nsis+objectivec+ocaml+opencl+oz+parigp+parser+pascal+perl+php+php-extras+sql+powershell+processing+prolog+properties+protobuf+pug+puppet+pure+python+q+qore+r+jsx+typescript+renpy+reason+rest+rip+roboconf+crystal+rust+sas+sass+scss+scala+scheme+smalltalk+smarty+plsql+soy+stylus+swift+tcl+textile+twig+tsx+vbnet+velocity+verilog+vhdl+vim+visual-basic+wasm+wiki+xeora+xojo+yaml&plugins=line-numbers+toolbar+show-language */\r\n\r\n    /**\r\n * prism.js default theme for JavaScript, CSS and HTML\r\n * Based on dabblet (http://dabblet.com)\r\n * @author Lea Verou\r\n */\r\n\r\n    /*\r\n* Dracula Theme for Prism.JS\r\n*\r\n* @author Gustavo Costa\r\n* e-mail: gusbemacbe@gmail.com\r\n*\r\n* @contributor Jon Leopard\r\n* e-mail: jonlprd@gmail.com\r\n*\r\n* @license MIT 2016-2018\r\n*/\r\n\r\n    code[class*='language-'],\r\n    pre[class*='language-'] {\r\n      color: #ccc;\r\n      background: rgb(40, 41, 54);\r\n    }\r\n\r\n    pre[class*='language-']::-moz-selection,\r\n    pre[class*='language-'] ::-moz-selection,\r\n    code[class*='language-']::-moz-selection,\r\n    code[class*='language-'] ::-moz-selection {\r\n      text-shadow: none;\r\n      background-color: #5a5f80;\r\n    }\r\n\r\n    pre[class*='language-']::selection,\r\n    pre[class*='language-'] ::selection,\r\n    code[class*='language-']::selection,\r\n    code[class*='language-'] ::selection {\r\n      text-shadow: none;\r\n      background-color: #5a5f80;\r\n    }\r\n\r\n    /* Inline code */\r\n\r\n    :not(pre) > code[class*='language-'] {\r\n      border-radius: 0.3em;\r\n      white-space: normal;\r\n    }\r\n\r\n    pre {\r\n      color: #ccc;\r\n      background: rgb(40, 41, 54);\r\n    }\r\n\r\n    .limit-300 {\r\n      height: 300px !important;\r\n    }\r\n\r\n    .limit-400 {\r\n      height: 400px !important;\r\n    }\r\n\r\n    .limit-500 {\r\n      height: 500px !important;\r\n    }\r\n\r\n    .limit-600 {\r\n      height: 600px !important;\r\n    }\r\n\r\n    .limit-700 {\r\n      height: 700px !important;\r\n    }\r\n\r\n    .limit-800 {\r\n      height: 800px !important;\r\n    }\r\n\r\n    .token.comment {\r\n      color: rgba(98, 114, 164, 1);\r\n    }\r\n\r\n    .token.prolog {\r\n      color: rgba(207, 207, 194, 1);\r\n    }\r\n\r\n    .token.tag {\r\n      color: rgba(220, 104, 170, 1);\r\n    }\r\n\r\n    .token.entity {\r\n      color: rgba(139, 233, 253, 1);\r\n    }\r\n\r\n    .token.atrule {\r\n      color: rgba(98, 239, 117, 1);\r\n    }\r\n\r\n    .token.url {\r\n      color: rgba(102, 217, 239, 1);\r\n    }\r\n\r\n    .token.selector {\r\n      color: rgba(207, 207, 194, 1);\r\n    }\r\n\r\n    .token.string {\r\n      color: rgba(241, 250, 140, 1);\r\n    }\r\n\r\n    .token.property {\r\n      color: rgba(255, 184, 108, 1);\r\n    }\r\n\r\n    .token.important {\r\n      color: rgba(255, 121, 198, 1);\r\n      font-weight: bold;\r\n    }\r\n\r\n    .token.punctuation {\r\n      color: rgba(230, 219, 116, 1);\r\n    }\r\n\r\n    .token.number {\r\n      color: rgba(189, 147, 249, 1);\r\n    }\r\n\r\n    .token.function {\r\n      color: rgba(80, 250, 123, 1);\r\n    }\r\n\r\n    .token.class-name {\r\n      color: rgba(255, 184, 108, 1);\r\n    }\r\n\r\n    .token.keyword {\r\n      color: rgba(255, 121, 198, 1);\r\n    }\r\n\r\n    .token.boolean {\r\n      color: rgba(255, 184, 108, 1);\r\n    }\r\n\r\n    .token.operator {\r\n      color: rgba(139, 233, 253, 1);\r\n    }\r\n\r\n    .token.char {\r\n      color: rgba(255, 135, 157, 1);\r\n    }\r\n\r\n    .token.regex {\r\n      color: rgba(80, 250, 123, 1);\r\n    }\r\n\r\n    .token.variable {\r\n      color: rgba(80, 250, 123, 1);\r\n    }\r\n\r\n    .token.constant {\r\n      color: rgba(255, 184, 108, 1);\r\n    }\r\n\r\n    .token.symbol {\r\n      color: rgba(255, 184, 108, 1);\r\n    }\r\n\r\n    .token.builtin {\r\n      color: rgba(255, 121, 198, 1);\r\n    }\r\n\r\n    .token.attr-value {\r\n      color: #7ec699;\r\n    }\r\n\r\n    .token.deleted {\r\n      color: #e2777a;\r\n    }\r\n\r\n    .token.namespace {\r\n      color: #e2777a;\r\n    }\r\n\r\n    .token.bold {\r\n      font-weight: bold;\r\n    }\r\n\r\n    .token.italic {\r\n      font-style: italic;\r\n    }\r\n\r\n    .token {\r\n      color: #ff79c6;\r\n    }\r\n\r\n    .langague-cpp .token.string {\r\n      color: #8be9fd;\r\n    }\r\n\r\n    .langague-c .token.string {\r\n      color: #8be9fd;\r\n    }\r\n\r\n    .language-css .token.selector {\r\n      color: rgba(80, 250, 123, 1);\r\n    }\r\n\r\n    .language-css .token.property {\r\n      color: rgba(255, 184, 108, 1);\r\n    }\r\n\r\n    .language-java span.token.class-name {\r\n      color: #8be9fd;\r\n    }\r\n\r\n    .language-java .token.class-name {\r\n      color: #8be9fd;\r\n    }\r\n\r\n    .language-markup .token.attr-value {\r\n      color: rgba(102, 217, 239, 1);\r\n    }\r\n\r\n    .language-markup .token.tag {\r\n      color: rgba(80, 250, 123, 1);\r\n    }\r\n\r\n    .language-objectivec .token.property {\r\n      color: #66d9ef;\r\n    }\r\n\r\n    .language-objectivec .token.string {\r\n      color: #50fa7b;\r\n    }\r\n\r\n    .language-php .token.boolean {\r\n      color: #8be9fd;\r\n    }\r\n\r\n    .language-php .token.function {\r\n      color: #ff79c6;\r\n    }\r\n\r\n    .language-php .token.keyword {\r\n      color: #66d9ef;\r\n    }\r\n\r\n    .language-ruby .token.symbol {\r\n      color: #8be9fd;\r\n    }\r\n\r\n    .language-ruby .token.class-name {\r\n      color: #cfcfc2;\r\n    }\r\n\r\n    pre.line-numbers {\r\n      position: relative;\r\n      padding-left: 3.8em;\r\n      counter-reset: linenumber;\r\n    }\r\n\r\n    pre.line-numbers > code {\r\n      position: relative;\r\n      white-space: inherit;\r\n    }\r\n\r\n    .line-numbers .line-numbers-rows {\r\n      position: absolute;\r\n      pointer-events: none;\r\n      top: 0;\r\n      font-size: 100%;\r\n      left: -3.8em;\r\n      width: 3em;\r\n      /* works for line-numbers below 1000 lines */\r\n      letter-spacing: -1px;\r\n      border-right: 1px solid #999;\r\n      -webkit-user-select: none;\r\n      -moz-user-select: none;\r\n      -ms-user-select: none;\r\n      user-select: none;\r\n    }\r\n\r\n    .line-numbers-rows > span {\r\n      pointer-events: none;\r\n      display: block;\r\n      counter-increment: linenumber;\r\n    }\r\n\r\n    .line-numbers-rows > span:before {\r\n      content: counter(linenumber);\r\n      color: #999;\r\n      display: block;\r\n      padding-right: 0.8em;\r\n      text-align: right;\r\n    }\r\n\r\n    div.code-toolbar {\r\n      position: relative;\r\n    }\r\n\r\n    div.code-toolbar > .toolbar {\r\n      position: absolute;\r\n      top: 0.3em;\r\n      right: 0.2em;\r\n      transition: opacity 0.3s ease-in-out;\r\n      opacity: 0;\r\n    }\r\n\r\n    div.code-toolbar:hover > .toolbar {\r\n      opacity: 1;\r\n    }\r\n\r\n    div.code-toolbar > .toolbar .toolbar-item {\r\n      display: inline-block;\r\n      padding-right: 20px;\r\n    }\r\n\r\n    div.code-toolbar > .toolbar a {\r\n      cursor: pointer;\r\n    }\r\n\r\n    div.code-toolbar > .toolbar button {\r\n      background: none;\r\n      border: 0;\r\n      color: inherit;\r\n      font: inherit;\r\n      line-height: normal;\r\n      overflow: visible;\r\n      padding: 0;\r\n      -webkit-user-select: none;\r\n      /* for button */\r\n      -moz-user-select: none;\r\n      -ms-user-select: none;\r\n    }\r\n\r\n    div.code-toolbar > .toolbar a,\r\n    div.code-toolbar > .toolbar button,\r\n    div.code-toolbar > .toolbar span {\r\n      color: #ccc;\r\n      font-size: 0.8em;\r\n      padding: 0.5em;\r\n      background: rgba(98, 114, 164, 1);\r\n      border-radius: 0.5em;\r\n    }\r\n\r\n    div.code-toolbar > .toolbar a:hover,\r\n    div.code-toolbar > .toolbar a:focus,\r\n    div.code-toolbar > .toolbar button:hover,\r\n    div.code-toolbar > .toolbar button:focus,\r\n    div.code-toolbar > .toolbar span:hover,\r\n    div.code-toolbar > .toolbar span:focus {\r\n      color: inherit;\r\n      text-decoration: none;\r\n      background-color: var(--verde);\r\n    }\r\n  `,\r\n  //   'duotone-light': css`\r\n  //     /*\r\n  // Name:   Duotone Light\r\n  // Author: Simurai, adapted from DuoTone themes for Atom (http://simurai.com/projects/2016/01/01/duotone-themes)\r\n  // Conversion: Bram de Haan (http://atelierbram.github.io/Base2Tone-prism/output/prism/prism-base2tone-morning-light.css)\r\n  // Generated with Base16 Builder (https://github.com/base16-builder/base16-builder)\r\n  // */\r\n\r\n  //     code[class*='language-'],\r\n  //     pre[class*='language-'] {\r\n  //       background: #faf8f5;\r\n  //       color: #728fcb;\r\n  //     }\r\n\r\n  //     pre[class*='language-']::-moz-selection,\r\n  //     pre[class*='language-'] ::-moz-selection,\r\n  //     code[class*='language-']::-moz-selection,\r\n  //     code[class*='language-'] ::-moz-selection {\r\n  //       text-shadow: none;\r\n  //       background: #faf8f5;\r\n  //     }\r\n\r\n  //     pre[class*='language-']::selection,\r\n  //     pre[class*='language-'] ::selection,\r\n  //     code[class*='language-']::selection,\r\n  //     code[class*='language-'] ::selection {\r\n  //       text-shadow: none;\r\n  //       background: #faf8f5;\r\n  //     }\r\n\r\n  //     pre {\r\n  //       background: #faf8f5;\r\n  //       color: #728fcb;\r\n  //     }\r\n\r\n  //     .token.comment,\r\n  //     .token.prolog,\r\n  //     .token.doctype,\r\n  //     .token.cdata {\r\n  //       color: #b6ad9a;\r\n  //     }\r\n\r\n  //     .token.punctuation {\r\n  //       color: #b6ad9a;\r\n  //     }\r\n\r\n  //     .token.namespace {\r\n  //       opacity: 0.7;\r\n  //     }\r\n\r\n  //     .token.tag,\r\n  //     .token.operator,\r\n  //     .token.number {\r\n  //       color: #063289;\r\n  //     }\r\n\r\n  //     .token.property,\r\n  //     .token.function {\r\n  //       color: #b29762;\r\n  //     }\r\n\r\n  //     .token.tag-id,\r\n  //     .token.selector,\r\n  //     .token.atrule-id {\r\n  //       color: #2d2006;\r\n  //     }\r\n\r\n  //     code.language-javascript,\r\n  //     .token.attr-name {\r\n  //       color: #896724;\r\n  //     }\r\n\r\n  //     code.language-css,\r\n  //     code.language-scss,\r\n  //     .token.boolean,\r\n  //     .token.string,\r\n  //     .token.entity,\r\n  //     .token.url,\r\n  //     .language-css .token.string,\r\n  //     .language-scss .token.string,\r\n  //     .style .token.string,\r\n  //     .token.attr-value,\r\n  //     .token.keyword,\r\n  //     .token.control,\r\n  //     .token.directive,\r\n  //     .token.unit,\r\n  //     .token.statement,\r\n  //     .token.regex,\r\n  //     .token.atrule {\r\n  //       color: #728fcb;\r\n  //     }\r\n\r\n  //     .token.placeholder,\r\n  //     .token.variable {\r\n  //       color: #93abdc;\r\n  //     }\r\n\r\n  //     .token.deleted {\r\n  //       text-decoration: line-through;\r\n  //     }\r\n\r\n  //     .token.inserted {\r\n  //       border-bottom: 1px dotted #2d2006;\r\n  //       text-decoration: none;\r\n  //     }\r\n\r\n  //     .token.italic {\r\n  //       font-style: italic;\r\n  //     }\r\n\r\n  //     .token.important,\r\n  //     .token.bold {\r\n  //       font-weight: bold;\r\n  //     }\r\n\r\n  //     .token.important {\r\n  //       color: #896724;\r\n  //     }\r\n\r\n  //     .token.entity {\r\n  //       cursor: help;\r\n  //     }\r\n\r\n  //     pre > code.highlight {\r\n  //       outline: 0.4em solid #896724;\r\n  //       outline-offset: 0.4em;\r\n  //     }\r\n\r\n  //     /* overrides color-values for the Line Numbers plugin\r\n  //  * http://prismjs.com/plugins/line-numbers/\r\n  //  */\r\n\r\n  //     .line-numbers .line-numbers-rows {\r\n  //       border-right-color: #ece8de;\r\n  //     }\r\n\r\n  //     .line-numbers-rows > span:before {\r\n  //       color: #cdc4b1;\r\n  //     }\r\n\r\n  //     /* overrides color-values for the Line Highlight plugin\r\n  //  * http://prismjs.com/plugins/line-highlight/\r\n  //  */\r\n\r\n  //     .line-highlight {\r\n  //       background: rgba(45, 32, 6, 0.2);\r\n  //       background: -webkit-linear-gradient(\r\n  //         left,\r\n  //         rgba(45, 32, 6, 0.2) 70%,\r\n  //         rgba(45, 32, 6, 0)\r\n  //       );\r\n  //       background: linear-gradient(\r\n  //         to right,\r\n  //         rgba(45, 32, 6, 0.2) 70%,\r\n  //         rgba(45, 32, 6, 0)\r\n  //       );\r\n  //     }\r\n  //   `,\r\n};\r\n\r\nexport default prismThemes;\r\n","import * as React from 'react';\r\nimport styled from 'styled-components';\r\nimport palette from '../../lib/styles/palette';\r\nimport media from '../../lib/styles/media';\r\n\r\nconst TypographyBlock = styled.div`\r\n  font-size: 1.125rem;\r\n  color: #222426;\r\n  line-height: 1.7;\r\n  letter-spacing: -0.004em;\r\n  word-break: keep-all;\r\n  word-wrap: break-word;\r\n  ul, ol, p {\r\n    /* ${media.xxlarge} {\r\n      color: ${palette.gray8};\r\n      font-weight: 300;\r\n    } */\r\n\r\n    b {\r\n      font-weight: 400;\r\n    }\r\n    code {\r\n      background: rgba(27,31,35,.05);\r\n      padding: .2em .4em;\r\n      font-size: 85%;\r\n      border-radius: 3px;\r\n    }\r\n    a {\r\n      code {\r\n        color: ${palette.teal6};\r\n      }\r\n    }\r\n  }\r\n  /* font-family: 'Spoqa Han Sans', -apple-system, BlinkMacSystemFont,\r\n    -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'Apple SD Gothic Neo',\r\n    arial, 나눔고딕, 'Nanum Gothic', 돋움; */\r\n\r\n  a {\r\n    color: ${palette.teal7};\r\n    text-decoration: none;\r\n    &:hover {\r\n      color: ${palette.teal6};\r\n      text-decoration: underline;\r\n    }\r\n  }\r\n  code {\r\n    font-family: 'Fira Mono', source-code-pro, Menlo, Monaco, Consolas,\r\n      'Courier New', monospace;\r\n  }\r\n\r\n  hr {\r\n    border: none;\r\n    height: 1px;\r\n    width: 100%;\r\n    background: #dedede;\r\n    margin-top: 2rem;\r\n    margin-bottom: 2rem;\r\n  }\r\n\r\n  p {\r\n    img {\r\n      display: block;\r\n      margin: 0 auto;\r\n      max-width: 100%;\r\n      margin-top: 3rem;\r\n      margin-bottom: 3rem;\r\n    }\r\n  }\r\n\r\n  h1 {\r\n    font-size: 2.5rem;\r\n  }\r\n  h2 {\r\n    font-size: 2rem;\r\n  }\r\n  h3 {\r\n    font-size: 1.5rem;\r\n  }\r\n  h4 {\r\n    font-size: 1.125rem;\r\n  }\r\n\r\n  h1,\r\n  h2,\r\n  h3,\r\n  h4 {\r\n    line-height: 1.5;\r\n    margin-bottom: 1rem;\r\n  }\r\n  p + h1,\r\n  p + h2,\r\n  p + h3,\r\n  p + h4 {\r\n    margin-top: 2.5rem;\r\n  }\r\n\r\n  ${media.small} {\r\n    font-size: 1rem;\r\n    h1 {\r\n      font-size: 2.25rem;\r\n    }\r\n    h2 {\r\n      font-size: 1.75rem;\r\n    }\r\n    h3 {\r\n      font-size: 1.25rem;\r\n    }\r\n    h4 {\r\n      font-size: 1rem;\r\n    }\r\n\r\n    h1,\r\n    h2,\r\n    h3,\r\n    h4 {\r\n      margin-bottom: 0.75rem;\r\n    }\r\n    p + h1,\r\n    p + h2,\r\n    p + h3,\r\n    p + h4 {\r\n      margin-top: 2rem;\r\n    }\r\n  }\r\n\r\n  blockquote {\r\n    margin-top: 2rem;\r\n    margin-bottom: 2rem;\r\n    border-left: 4px solid ${palette.teal5};\r\n    border-top-right-radius: 4px;\r\n    border-bottom-right-radius: 4px;\r\n    background: ${palette.gray0};\r\n    margin-left: 0;\r\n    margin-right: 0;\r\n    padding: 1rem;\r\n    padding-left: 2rem;\r\n    color: ${palette.gray9};\r\n    ul, ol {\r\n      padding-left: 1rem;\r\n    }\r\n    *:first-child {\r\n      margin-top: 0;\r\n    }\r\n    *:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n  }\r\n`;\r\n\r\nexport interface TypographyProps {}\r\n\r\nconst Typography: React.FC<TypographyProps> = ({ children }) => {\r\n  return <TypographyBlock>{children}</TypographyBlock>;\r\n};\r\n\r\nexport default Typography;\r\n","const tags = [\r\n  'math',\r\n  'annotation',\r\n  'semantics',\r\n  'mtext',\r\n  'mn',\r\n  'mo',\r\n  'mi',\r\n  'mspace',\r\n  'mover',\r\n  'munder',\r\n  'munderover',\r\n  'msup',\r\n  'msub',\r\n  'msubsup',\r\n  'mfrac',\r\n  'mroot',\r\n  'msqrt',\r\n  'mtable',\r\n  'mtr',\r\n  'mtd',\r\n  'mlabeledtr',\r\n  'mrow',\r\n  'menclose',\r\n  'mstyle',\r\n  'mpadded',\r\n  'mphantom',\r\n  'mglyph',\r\n  'svg',\r\n  'path',\r\n  'line',\r\n];\r\n\r\nconst attributes = tags.reduce((acc, current) => {\r\n  acc[current] = ['*'];\r\n  return acc;\r\n}, {} as Record<string, string[]>);\r\n\r\nconst styles = [\r\n  'background-color',\r\n  'border-bottom-width',\r\n  'border-color',\r\n  'border-right-style',\r\n  'border-right-width',\r\n  'border-top-width',\r\n  'border-style',\r\n  'border-width',\r\n  'bottom',\r\n  'color',\r\n  'height',\r\n  'left',\r\n  'margin',\r\n  'margin-left',\r\n  'margin-right',\r\n  'margin-top',\r\n  'min-width',\r\n  'padding-left',\r\n  'position',\r\n  'top',\r\n  'width',\r\n  'vertical-align',\r\n].reduce((acc, current) => {\r\n  acc[current] = [/.*/];\r\n  return acc;\r\n}, {} as Record<string, RegExp[]>);\r\n\r\nconst katexWhitelist = {\r\n  tags,\r\n  attributes,\r\n  styles,\r\n};\r\n\r\nexport default katexWhitelist;\r\n","import * as React from 'react';\r\nimport styled from 'styled-components';\r\nimport remark from 'remark';\r\n// import htmlPlugin from 'remark-html';\r\nimport slug from 'remark-slug';\r\nimport prismPlugin from '../../lib/remark/prismPlugin';\r\nimport prismThemes from '../../lib/styles/prismThemes';\r\nimport breaks from 'remark-breaks';\r\nimport Typography from './Typography';\r\nimport embedPlugin from '../../lib/remark/embedPlugin';\r\nimport { loadScript, ssrEnabled } from '../../lib/utils';\r\nimport media from '../../lib/styles/media';\r\nimport parse from 'html-react-parser';\r\nimport { throttle } from 'throttle-debounce';\r\nimport sanitize from 'sanitize-html';\r\nimport palette from '../../lib/styles/palette';\r\nimport math from 'remark-math';\r\nimport remark2rehype from 'remark-rehype';\r\nimport katex from 'rehype-katex';\r\nimport raw from 'rehype-raw';\r\nimport remarkParse from 'remark-parse';\r\nimport stringify from 'rehype-stringify';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport katexWhitelist from '../../lib/katexWhitelist';\r\n\r\nexport interface MarkdownRenderProps {\r\n  markdown: string;\r\n  codeTheme?: string;\r\n  onConvertFinish?: (html: string) => any;\r\n  editing?: boolean;\r\n}\r\n\r\nconst MarkdownRenderBlock = styled.div`\r\n  &.atom-one-dark {\r\n    ${prismThemes['atom-one-dark']}\r\n  }\r\n  &.atom-one-light {\r\n    ${prismThemes['atom-one-light']}\r\n  }\r\n  &.github {\r\n    ${prismThemes['github']}\r\n  }\r\n  &.monokai {\r\n    ${prismThemes['monokai']}\r\n  }\r\n  &.dracula {\r\n    ${prismThemes['dracula']}\r\n  }\r\n\r\n  pre {\r\n    font-family: 'Fira Mono', source-code-pro, Menlo, Monaco, Consolas,\r\n      'Courier New', monospace;\r\n    font-size: 1rem;\r\n    padding: 1rem;\r\n    border-radius: 4px;\r\n    line-height: 1.5;\r\n    overflow-x: auto;\r\n    letter-spacing: 0px;\r\n    ${media.small} {\r\n      font-size: 0.75rem;\r\n      padding: 0.75rem;\r\n    }\r\n  }\r\n\r\n  img {\r\n    max-width: 100%;\r\n    height: auto;\r\n    display: block;\r\n    margin-top: 1.5rem;\r\n    margin-bottom: 1.5rem;\r\n  }\r\n\r\n  iframe {\r\n    width: 768px;\r\n    height: 430px;\r\n    max-width: 100%;\r\n    background: black;\r\n    display: block;\r\n    margin: auto;\r\n    border: none;\r\n    border-radius: 4px;\r\n    overflow: hidden;\r\n  }\r\n\r\n  .twitter-wrapper {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    border-left: none;\r\n    background: none;\r\n    padding: none;\r\n  }\r\n\r\n  table {\r\n    min-width: 40%;\r\n    max-width: 100%;\r\n    border: 1px solid ${palette.gray7};\r\n    border-collapse: collapse;\r\n    font-size: 0.875rem;\r\n    thead > tr > th {\r\n      /* text-align: left; */\r\n      border-bottom: 4px solid ${palette.gray7};\r\n    }\r\n    th,\r\n    td {\r\n      word-break: break-word;\r\n      padding: 0.5rem;\r\n    }\r\n\r\n    td + td,\r\n    th + th {\r\n      border-left: 1px solid ${palette.gray7};\r\n    }\r\n\r\n    tr:nth-child(even) {\r\n      background: ${palette.gray1};\r\n    }\r\n    tr:nth-child(odd) {\r\n      background: white;\r\n    }\r\n  }\r\n\r\n  .katex-mathml {\r\n    display: none;\r\n  }\r\n`;\r\n\r\nfunction filter(html: string) {\r\n  return sanitize(html, {\r\n    allowedTags: [\r\n      'h1',\r\n      'h2',\r\n      'h3',\r\n      'h4',\r\n      'h5',\r\n      'h6',\r\n      'blockquote',\r\n      'p',\r\n      'a',\r\n      'ul',\r\n      'ol',\r\n      'nl',\r\n      'li',\r\n      'b',\r\n      'i',\r\n      'strong',\r\n      'em',\r\n      'strike',\r\n      'code',\r\n      'hr',\r\n      'br',\r\n      'div',\r\n      'table',\r\n      'thead',\r\n      'caption',\r\n      'tbody',\r\n      'tr',\r\n      'th',\r\n      'td',\r\n      'pre',\r\n      'iframe',\r\n      'span',\r\n      'img',\r\n      'del',\r\n      'input',\r\n\r\n      ...katexWhitelist.tags,\r\n    ],\r\n    allowedAttributes: {\r\n      a: ['href', 'name', 'target'],\r\n      img: ['src'],\r\n      iframe: ['src', 'allow', 'allowfullscreen', 'scrolling', 'class'],\r\n      '*': ['class', 'id', 'aria-hidden'],\r\n      span: ['style'],\r\n      input: ['type'],\r\n      ...katexWhitelist.attributes,\r\n    },\r\n    allowedStyles: {\r\n      '*': {\r\n        // Match HEX and RGB\r\n        color: [\r\n          /^#(0x)?[0-9a-f]+$/i,\r\n          /^rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)$/,\r\n        ],\r\n        'text-align': [/^left$/, /^right$/, /^center$/],\r\n      },\r\n      span: {\r\n        ...katexWhitelist.styles,\r\n      },\r\n    },\r\n    allowedIframeHostnames: ['www.youtube.com', 'codesandbox.io', 'codepen.io'],\r\n  });\r\n}\r\n\r\nconst { useState, useEffect } = React;\r\n\r\ntype RenderedElement =\r\n  | string\r\n  | React.DetailedReactHTMLElement<{}, HTMLElement>\r\n  | Array<React.DetailedReactHTMLElement<{}, HTMLElement>>\r\n  | null;\r\n\r\nconst MarkdownRender: React.FC<MarkdownRenderProps> = ({\r\n  markdown,\r\n  codeTheme = 'atom-one-light',\r\n  onConvertFinish,\r\n  editing,\r\n}) => {\r\n  const [html, setHtml] = useState(\r\n    ssrEnabled\r\n      ? filter(\r\n          remark()\r\n            .use(remarkParse)\r\n            .use(slug)\r\n            .use(prismPlugin)\r\n            .use(embedPlugin)\r\n            .use(remark2rehype, { allowDangerousHTML: true })\r\n            .use(raw)\r\n            .use(breaks)\r\n            .use(math)\r\n            .use(katex)\r\n            .use(stringify)\r\n            .processSync(markdown)\r\n            .toString(),\r\n        )\r\n      : '',\r\n  );\r\n\r\n  const [element, setElement] = useState<RenderedElement>(null);\r\n  const [hasTagError, setHasTagError] = useState(false);\r\n  const [delay, setDelay] = useState(25);\r\n\r\n  const throttledUpdate = React.useMemo(() => {\r\n    return throttle(delay, (markdown: string) => {\r\n      remark()\r\n      .use(remarkParse)\r\n      .use(slug)\r\n      .use(prismPlugin)\r\n      .use(embedPlugin)\r\n      .use(remark2rehype, { allowDangerousHTML: true })\r\n      .use(raw)\r\n      .use(breaks)\r\n      .use(math)\r\n      .use(katex)\r\n      .use(stringify)\r\n      .process(markdown, (err: any, file: any) => {\r\n        const lines = markdown.split(/\\r\\n|\\r|\\n/).length\r\n        const nextDelay = Math.max(Math.min(Math.floor(lines * 0.5), 1500), 22)\r\n        if (nextDelay !== delay) {\r\n          setDelay(nextDelay)\r\n        }\r\n        const html = String(file);\r\n\r\n        if (onConvertFinish) {\r\n          onConvertFinish(html);\r\n        }\r\n        // load twitter script if needed\r\n        if (html.indexOf('class=\"twitter-tweet\"') !== -1) {\r\n          // if (window && (window as any).twttr) return;\r\n          loadScript('https://platform.twitter.com/widgets.js');\r\n        }\r\n\r\n        if (!editing) {\r\n          setHtml(filter(html));\r\n          return;\r\n        }\r\n\r\n        try {\r\n          const el = parse(html);\r\n          setHasTagError(false);\r\n          setElement(el as any);\r\n        } catch (e) {}\r\n    }, 1)\r\n    });\r\n  }, [delay, editing, onConvertFinish]);\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    throttledUpdate(markdown)    \r\n  }, [markdown, throttledUpdate]);\r\n\r\n  return (\r\n    <Typography>\r\n      <Helmet>\r\n        {/\\$(.*)\\$/.test(markdown) && (\r\n          <link\r\n            rel=\"stylesheet\"\r\n            href=\"https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css\"\r\n            integrity=\"sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq\"\r\n            crossOrigin=\"anonymous\"\r\n          />\r\n        )}\r\n      </Helmet>\r\n      {editing ? (\r\n        <MarkdownRenderErrorBoundary\r\n          onError={() => setHasTagError(true)}\r\n          hasTagError={hasTagError}\r\n        >\r\n          <MarkdownRenderBlock className={codeTheme}>\r\n            {element}\r\n          </MarkdownRenderBlock>\r\n        </MarkdownRenderErrorBoundary>\r\n      ) : (\r\n        <MarkdownRenderBlock\r\n          className={codeTheme}\r\n          dangerouslySetInnerHTML={{ __html: html }}\r\n        />\r\n      )}\r\n    </Typography>\r\n  );\r\n};\r\n\r\ntype ErrorBoundaryProps = {\r\n  onError: () => void;\r\n  hasTagError: boolean;\r\n};\r\nclass MarkdownRenderErrorBoundary extends React.Component<ErrorBoundaryProps> {\r\n  state = {\r\n    hasError: false,\r\n  };\r\n  componentDidCatch() {\r\n    this.setState({\r\n      hasError: true,\r\n    });\r\n    this.props.onError();\r\n  }\r\n\r\n  componentDidUpdate(prevProps: ErrorBoundaryProps) {\r\n    if (prevProps.hasTagError && !this.props.hasTagError) {\r\n      this.setState({\r\n        hasError: false,\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return <div>HTML 태그 파싱 실패</div>;\r\n    }\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport default React.memo(MarkdownRender);\r\n","import * as React from 'react';\r\nimport styled from 'styled-components';\r\nimport MarkdownRender from '../common/MarkdownRender';\r\nimport palette from '../../lib/styles/palette';\r\n\r\nconst MarkdownPreviewBlock = styled.div`\r\n  word-break: break-word;\r\n  padding: 3rem;\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  color: ${palette.gray9};\r\n`;\r\n\r\nconst Title = styled.h1`\r\n  font-size: 2.5em;\r\n  margin-bottom: 4rem;\r\n  font-weight: 800;\r\n`;\r\n\r\nexport interface MarkdownPreviewProps {\r\n  markdown: string;\r\n  title: string;\r\n  className?: string;\r\n}\r\n\r\nconst MarkdownPreview: React.FC<MarkdownPreviewProps> = ({\r\n  markdown,\r\n  title,\r\n  className,\r\n}) => {\r\n  return (\r\n    <MarkdownPreviewBlock id=\"preview\">\r\n      <Title>{title}</Title>\r\n      <MarkdownRender markdown={markdown} editing />\r\n    </MarkdownPreviewBlock>\r\n  );\r\n};\r\n\r\nexport default MarkdownPreview;\r\n","import * as React from 'react';\r\nimport MarkdownPreview from '../../components/write/MarkdownPreview';\r\nimport { connect } from 'react-redux';\r\nimport { RootState } from '../../modules';\r\n\r\ninterface OwnProps {}\r\ninterface StateProps {\r\n  markdown: string;\r\n  title: string;\r\n}\r\ninterface DispatchProps {}\r\ntype MarkdownPreviewContainerProps = OwnProps & StateProps & DispatchProps;\r\n\r\nconst MarkdownPreviewContainer: React.FC<MarkdownPreviewContainerProps> = ({\r\n  markdown,\r\n  title,\r\n}) => {\r\n  return <MarkdownPreview markdown={markdown} title={title} />;\r\n};\r\n\r\nexport default connect<StateProps, DispatchProps, OwnProps, RootState>(\r\n  ({ write }) => ({\r\n    markdown: write.markdown,\r\n    title: write.title,\r\n  }),\r\n  dispatch => ({}),\r\n)(MarkdownPreviewContainer);\r\n","import * as React from 'react';\r\nimport EditorPanes from '../../components/write/EditorPanes';\r\nimport MarkdownEditorContainer from './MarkdownEditorContainer';\r\nimport MarkdownPreviewContainer from './MarkdownPreviewContainer';\r\n\r\ninterface EditorPanesContainerProps {}\r\n\r\nconst EditorPanesContainer: React.FC<EditorPanesContainerProps> = props => {\r\n  return (\r\n    <EditorPanes\r\n      left={<MarkdownEditorContainer />}\r\n      right={<MarkdownPreviewContainer />}\r\n    />\r\n  );\r\n};\r\n\r\nexport default EditorPanesContainer;\r\n","import React from 'react';\r\nimport EditorPanesContainer from './container/write/EditorPanesContainer';\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <EditorPanesContainer></EditorPanesContainer>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      process.env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import { deprecated } from 'typesafe-actions';\r\nimport { AuthMode } from './types';\r\n// import { CurrentUser } from '../../lib/graphql/user';\r\n\r\nconst { createStandardAction } = deprecated;\r\n\r\nexport const SET_LAYER = 'core/SET_LAYER';\r\nexport const SHOW_AUTH_MODAL = 'core/SHOW_AUTH_MODAL';\r\nexport const CHANGE_AUTH_MODAL_MODE = 'core/CHANGE_AUTH_MODAL_MODE';\r\nexport const CLOSE_AUTH_MODAL = 'core/CLOSE_AUTH_MODAL';\r\nexport const SET_USER = 'core/SET_USER';\r\nexport const OPEN_POPUP = 'core/OPEN_POPUP';\r\nexport const CLOSE_POPUP = 'core/CLOSE_POPUP';\r\n\r\nexport const setLayer = createStandardAction(SET_LAYER)<boolean>();\r\nexport const showAuthModal = createStandardAction(SHOW_AUTH_MODAL)<AuthMode>();\r\nexport const changeAuthModalMode = createStandardAction(CHANGE_AUTH_MODAL_MODE)<\r\n  AuthMode\r\n>();\r\nexport const closeAuthModal = createStandardAction(CLOSE_AUTH_MODAL)();\r\n// export const setUser = createStandardAction(SET_USER)<CurrentUser | nulㅍl>();\r\n\r\nexport const openPopup = createStandardAction(OPEN_POPUP)<{\r\n  title?: string;\r\n  message: string;\r\n}>();\r\nexport const closePopup = createStandardAction(CLOSE_POPUP)();\r\n","import { createReducer } from 'typesafe-actions';\r\nimport { CoreState, CoreAction } from './types';\r\nimport {\r\n  SET_LAYER,\r\n  SHOW_AUTH_MODAL,\r\n  CHANGE_AUTH_MODAL_MODE,\r\n  CLOSE_AUTH_MODAL,\r\n  // SET_USER,\r\n  OPEN_POPUP,\r\n  CLOSE_POPUP,\r\n} from './actions';\r\nimport produce from 'immer';\r\n// import { updateKey } from '../../lib/utils';\r\n\r\nconst initialState: CoreState = {\r\n  layer: false,\r\n  auth: {\r\n    visible: false,\r\n    mode: 'LOGIN',\r\n  },\r\n  // user: null,\r\n  popup: {\r\n    visible: false,\r\n    title: '',\r\n    message: '',\r\n  },\r\n};\r\n\r\nconst core = createReducer<CoreState, CoreAction>(initialState, {\r\n  [SET_LAYER]: (state, action) => ({\r\n    ...state,\r\n    layer: action.payload,\r\n  }),\r\n  [SHOW_AUTH_MODAL]: (state, action) =>\r\n    produce(state, draft => {\r\n      draft.auth.mode = action.payload;\r\n      draft.auth.visible = true;\r\n      draft.layer = true;\r\n    }),\r\n  [CHANGE_AUTH_MODAL_MODE]: (state, action) =>\r\n    produce(state, draft => {\r\n      draft.auth.mode = action.payload;\r\n    }),\r\n  [CLOSE_AUTH_MODAL]: state =>\r\n    produce(state, draft => {\r\n      draft.auth.visible = false;\r\n      draft.layer = false;\r\n    }),\r\n  // [SET_USER]: (state, { payload: user }) => updateKey(state, 'user', user),\r\n  [OPEN_POPUP]: (state, action) =>\r\n    produce(state, draft => {\r\n      draft.popup.title = action.payload.title;\r\n      draft.popup.message = action.payload.message;\r\n      draft.popup.visible = true;\r\n    }),\r\n  [CLOSE_POPUP]: state =>\r\n    produce(state, draft => {\r\n      draft.popup.visible = false;\r\n    }),\r\n});\r\n\r\nexport default core;\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport { RootState } from '.';\r\n\r\nexport interface PostState {\r\n  id: string | null;\r\n}\r\n\r\nconst initialState: PostState = {\r\n  id: null,\r\n};\r\n\r\nconst post = createSlice({\r\n  name: 'post',\r\n  initialState,\r\n  reducers: {\r\n    setPostId(state, action: PayloadAction<string>) {\r\n      state.id = action.payload;\r\n    },\r\n  },\r\n});\r\n\r\nexport const selectPostId = (state: RootState) => state.post.id;\r\n\r\nexport default post;\r\n","import { createSlice } from '@reduxjs/toolkit';\r\n\r\nexport type ErrorState = {\r\n  errorType: 'NOT_FOUND' | 'CRASHED' | null;\r\n};\r\n\r\nconst initialState: ErrorState = {\r\n  errorType: null,\r\n};\r\n\r\nconst error = createSlice({\r\n  name: 'error',\r\n  initialState,\r\n  reducers: {\r\n    showNotFound(state) {\r\n      state.errorType = 'NOT_FOUND';\r\n    },\r\n    reset(state) {\r\n      state.errorType = null;\r\n    },\r\n  },\r\n});\r\n\r\nexport default error;\r\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\n\r\nexport type ScrollState = {\r\n  main: number;\r\n  'user/posts': number;\r\n};\r\n\r\nexport type ScrollKey = keyof ScrollState;\r\n\r\nconst initialState: ScrollState = {\r\n  main: 0,\r\n  'user/posts': 0,\r\n};\r\n\r\nconst scroll = createSlice({\r\n  name: 'scroll',\r\n  initialState,\r\n  reducers: {\r\n    preserveScroll(\r\n      state,\r\n      { payload: { key, top } }: PayloadAction<{ key: ScrollKey; top: number }>,\r\n    ) {\r\n      state[key] = top;\r\n    },\r\n  },\r\n});\r\n\r\nexport default scroll;\r\n","import { combineReducers } from 'redux';\r\nimport core, { CoreState } from './core';\r\nimport write, { WriteState } from './write';\r\nimport post, { PostState } from './post';\r\nimport error, { ErrorState } from './error';\r\nimport scroll, { ScrollState } from './scroll';\r\n\r\nexport type RootState = {\r\n  core: CoreState;\r\n  write: WriteState;\r\n  post: PostState;\r\n  error: ErrorState;\r\n  scroll: ScrollState;\r\n};\r\n\r\nconst rootReducer = combineReducers({\r\n  core,\r\n  write,\r\n  post: post.reducer,\r\n  error: error.reducer,\r\n  scroll: scroll.reducer,\r\n});\r\n\r\nexport default rootReducer;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport './typography.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport { createStore } from 'redux';\r\nimport { Provider } from 'react-redux';\r\nimport { HelmetProvider } from 'react-helmet-async';\r\nimport rootReducer from './modules';\r\n\r\nconst store = createStore(\r\n  rootReducer,\r\n  (window as any).__REDUX_STATE__,\r\n  // composeWithDevTools(),\r\n);\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <HelmetProvider>\r\n      <Provider store={store}>\r\n        <App />\r\n      </Provider>\r\n    </HelmetProvider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workersㅊ: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}